<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tobit Bayes • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Tobit Bayes</h1>
            
            <h4 class="date">2017-06-06</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.1.90000</em></p>
<hr>
<p>Bayesian Tobit Regression with <code>tobit.bayes</code>.</p>
<p>Bayesian tobit regression estimates a linear regression model with a censored dependent variable using a Gibbs sampler. The dependent variable may be censored from below and/or from above. For other linear regression models with fully observed dependent variables, see Bayesian regression, maximum likelihood normal regression, or least squares.</p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">below =</span> <span class="dv">0</span>, <span class="dt">above =</span> <span class="ot">Inf</span>,
               <span class="dt">model =</span> <span class="st">"tobit.bayes"</span>, <span class="dt">weights =</span> w, <span class="dt">data =</span> mydata)
x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)
s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
</div>
<div id="inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#inputs" class="anchor"></a>Inputs</h2>
<p>zelig() accepts the following arguments to specify how the dependent variable is censored.</p>
<ul>
<li><p><code>below</code>: point at which the dependent variable is censored from below. If the dependent variable is only censored from above, set <code>below = -Inf</code>. The default value is 0.</p></li>
<li><p><code>above</code>: point at which the dependent variable is censored from above. If the dependent variable is only censored from below, set <code>above = Inf</code>. The default value is <code>Inf</code>.</p></li>
</ul>
</div>
<div id="additional-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-inputs" class="anchor"></a>Additional Inputs</h2>
<p>Use the following arguments to monitor the convergence of the Markov chain:</p>
<ul>
<li><p><code>burnin</code>: number of the initial MCMC iterations to be discarded (defaults to 1,000).</p></li>
<li><p><code>mcmc</code>: number of the MCMC iterations after burnin (defaults to 10,000).</p></li>
<li><p><code>thin</code>: thinning interval for the Markov chain. Only every <code>thin</code>-th draw from the Markov chain is kept. The value of <code>mcmc</code> must be divisible by this value. The default value is 1.</p></li>
<li><p><code>verbose</code>: defaults to FALSE. If <code>TRUE</code>, the progress of the sampler (every <span class="math inline">\(10\%\)</span>) is printed to the screen.</p></li>
<li><p><code>seed</code>: seed for the random number generator. The default is <code>NA</code> which corresponds to a random seed of 12345.</p></li>
<li><p><code>beta.start</code>: starting values for the Markov chain, either a scalar or vector with length equal to the number of estimated coefficients. The default is <code>NA</code>, such that the least squares estimates are used as the starting values.</p></li>
</ul>
<p>Use the following parameters to specify the model’s priors:</p>
<ul>
<li><p><code>b0</code>: prior mean for the coefficients, either a numeric vector or a scalar. If a scalar, that value will be the prior mean for all coefficients. The default is 0.</p></li>
<li><p><code>B0</code>: prior precision parameter for the coefficients, either a square matrix (with the dimensions equal to the number of the coefficients) or a scalar. If a scalar, that value times an identity matrix will be the prior precision parameter. The default is 0, which leads to an improper prior.</p></li>
<li><p><code>c0</code>: <code>c0/2</code> is the shape parameter for the Inverse Gamma prior on the variance of the disturbance terms.</p></li>
<li><p><code>d0</code>: <code>d0/2</code> is the scale parameter for the Inverse Gamma prior on the variance of the disturbance terms.</p></li>
</ul>
<p>Zelig users may wish to refer to <code>help(MCMCtobit)</code> for more information.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="basic-example" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-example" class="anchor"></a>Basic Example</h3>
<p>Attaching the sample dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(tobin)</code></pre></div>
<p>Estimating linear regression using <code>tobit.bayes</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(durable <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>quant, <span class="dt">model =</span> <span class="st">"tobit.bayes"</span>,
               <span class="dt">data =</span> tobin, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Ben Goodrich, and Ying Lu. 2013.
##   tobit-bayes: Bayesian Tobit Regression for a Censored Dependent Variable
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<p>You can check for convergence before summarizing the estimates with three diagnostic tests. See the section <a href="diagnostics.html">Diagnostics for Zelig Models</a> for examples of the output with interpretation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out<span class="op">$</span><span class="kw">geweke.diag</span>()
z.out<span class="op">$</span><span class="kw">heidel.diag</span>()
z.out<span class="op">$</span><span class="kw">raftery.diag</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out)</code></pre></div>
<pre><code>## Model: 
## 
## Iterations = 1001:11000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                  Mean       SD Naive SE Time-series SE
## (Intercept)  18.24881  41.2238 0.412238       0.738521
## age          -0.28131   0.6070 0.006070       0.014936
## quant        -0.04816   0.1485 0.001485       0.002272
## sigma2      186.84624 433.9812 4.339812      21.462492
## 
## 2. Quantiles for each variable:
## 
##                 2.5%     25%      50%       75%    97.5%
## (Intercept) -59.1541 -0.7344 17.48159  35.82751 100.1944
## age          -1.6027 -0.5018 -0.21511   0.02447   0.6598
## quant        -0.3361 -0.1149 -0.04628   0.01886   0.2289
## sigma2       19.6083 49.1654 88.57180 178.15120 917.7208
## 
## Next step: Use 'setx' method</code></pre>
<p>Setting values for the explanatory variables to their sample averages:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)</code></pre></div>
<p>Simulating quantities of interest from the posterior distribution given <code>x.out</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s.out1)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##       mean       sd     50%      2.5%    97.5%
## 1 2.093275 1.451578 1.74511 0.5979316 5.694411
## pv
##          mean       sd      50% 2.5%    97.5%
## [1,] 5.713629 9.426081 1.806649    0 29.96906</code></pre>
</div>
<div id="simulating-first-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-first-differences" class="anchor"></a>Simulating First Differences</h3>
<p>Set explanatory variables to their default(mean/mode) values, with high (80th percentile) and low (20th percentile) liquidity ratio (<code>quant</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.high &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out, <span class="dt">quant =</span> <span class="kw">quantile</span>(tobin<span class="op">$</span>quant, <span class="dt">prob =</span> <span class="fl">0.8</span>))
x.low &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out, <span class="dt">quant =</span> <span class="kw">quantile</span>(tobin<span class="op">$</span>quant, <span class="dt">prob =</span> <span class="fl">0.2</span>))</code></pre></div>
<p>Estimating the first difference for the effect of high versus low liquidity ratio on duration(<code>durable</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.high, <span class="dt">x1 =</span> x.low)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s.out2)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##       mean       sd      50%      2.5%    97.5%
## 1 1.883163 1.859314 1.412404 0.2393809 6.341747
## pv
##          mean       sd      50% 2.5%    97.5%
## [1,] 5.624543 9.712387 1.555601    0 30.37524
## 
##  sim x1 :
##  -----
## ev
##       mean       sd      50%      2.5%    97.5%
## 1 2.581795 1.894538 2.149404 0.5747006 7.390108
## pv
##          mean       sd      50% 2.5%    97.5%
## [1,] 5.955529 9.338868 2.278004    0 30.40807
## fd
##        mean       sd       50%      2.5%    97.5%
## 1 0.6986325 2.149956 0.6738879 -3.383639 4.875659</code></pre>
</div>
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>Let <span class="math inline">\(Y_i^*\)</span> be the dependent variable which is not directly observed. Instead, we observe <span class="math inline">\(Y_i\)</span> which is defined as following:</p>
<p><span class="math display">\[
    Y_i = \left\{
        \begin{array}{lcl}
   Y_i^*  &amp;\textrm{if} &amp; c_1&lt;Y_i^*&lt;c_2 \\
   c_1    &amp;\textrm{if} &amp; c_1 \ge Y_i^* \\
   c_2    &amp;\textrm{if} &amp; c_2 \le Y_i^*
   \end{array}\right.
\]</span></p>
<p>where <span class="math inline">\(c_1\)</span> is the lower bound below which <span class="math inline">\(Y_i^*\)</span> is censored, and <span class="math inline">\(c_2\)</span> is the upper bound above which <span class="math inline">\(Y_i^*\)</span> is censored.</p>
<ul>
<li>The <em>stochastic component</em> is given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \epsilon_{i}  &amp;  \sim &amp; \textrm{Normal}(0, \sigma^2)\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\epsilon_{i}=Y^*_i-\mu_i\)</span>.</p>
<ul>
<li>The <em>systematic component</em> is given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \mu_{i}= x_{i} \beta,\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(x_{i}\)</span> is the vector of <span class="math inline">\(k\)</span> explanatory variables for observation <span class="math inline">\(i\)</span> and <span class="math inline">\(\beta\)</span> is the vector of coefficients.</p>
<ul>
<li>The <em>semi-conjugate priors</em> for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma^2\)</span> are given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \beta &amp; \sim &amp; \textrm{Normal}_k \left( b_{0},B_{0}^{-1}\right) \\
      \sigma^{2} &amp; \sim &amp; \textrm{InverseGamma} \left( \frac{c_0}{2}, \frac{d_0}{2}
      \right) \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(b_{0}\)</span> is the vector of means for the <span class="math inline">\(k\)</span> explanatory variables, <span class="math inline">\(B_{0}\)</span> is the <span class="math inline">\(k\times k\)</span> precision matrix (the inverse of a variance-covariance matrix), and <span class="math inline">\(c_0/2\)</span> and <span class="math inline">\(d_0/2\)</span> are the shape and scale parameters for <span class="math inline">\(\sigma^{2}\)</span>. Note that <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma^2\)</span> are assumed <em>a priori</em> independent.</p>
</div>
<div id="quantities-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#quantities-of-interest" class="anchor"></a>Quantities of Interest</h2>
<ul>
<li>The expected values (<code>qi$ev</code>) for the tobit regression model is calculated as following. Let</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \Phi_1 &amp;=&amp; \Phi\left(\frac{(c_1 - x \beta)}{\sigma}\right) \\
      \Phi_2 &amp;=&amp; \Phi\left(\frac{(c_2 - x \beta)}{\sigma}\right) \\
      \phi_1 &amp;=&amp; \phi\left(\frac{(c_1 - x \beta)}{\sigma}\right) \\
      \phi_2 &amp;=&amp; \phi\left(\frac{(c_2 - x \beta)}{\sigma}\right) \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\Phi(\cdot)\)</span> is the (cumulative) Normal density function and <span class="math inline">\(\phi(\cdot)\)</span> is the Normal probability density function of the standard normal distribution. Then the expected values are</p>
<p><span class="math display">\[
    \begin{aligned}
        E(Y|x) &amp;=&amp; P(Y^* \le c_1|x) c_1+P(c_1&lt;Y^*&lt;c_2|x) E(Y^* \mid c_1&lt;Y^*&lt;c_2, x)+P(Y^* \ge c_2) c_2 \\
         &amp;=&amp; \Phi_{1}c_1 + x \beta(\Phi_{2}-\Phi_{1}) + \sigma (\phi_1 -\phi_2) + (1-\Phi_2) c_2,\end{aligned}
\]</span></p>
<ul>
<li>The first difference (<code>qi$fd</code>) for the tobit regression model is defined as</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \text{FD}=E(Y\mid x_{1})-E(Y\mid x).\end{aligned}
\]</span></p>
<ul>
<li>In conditional prediction models, the average expected treatment effect (<code>qi$att.ev</code>) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \frac{1}{\sum t_{i}}\sum_{i:t_{i}=1}[Y_{i}(t_{i}=1)-E[Y_{i}(t_{i}=0)]],\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(t_{i}\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_{i}=1\)</span>) and control (<span class="math inline">\(t_{i}=0\)</span>) groups.</p>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The Zelig object stores fields containing everything needed to rerun the Zelig output, and all the results and simulations as they are generated. In addition to the summary commands demonstrated above, some simply utility functions (known as <em>getters</em>) provide easy access to the raw fields most commonly of use for further investigation.</p>
<p>In the example above <code>z.out$get_coef()</code> returns the estimated coefficients, <code>z.out$get_vcov()</code> returns the estimated covariance matrix, and <code>z.out$get_predict()</code> provides predicted values for all observations in the dataset from the analysis.</p>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>Bayesian tobit regression is part of the MCMCpack library by Andrew D. Martin and Kevin M. Quinn. The convergence diagnostics are part of the CODA library by Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines.</p>
<p>Martin AD, Quinn KM and Park JH (2011). “MCMCpack: Markov Chain Monte Carlo in R.” <em>Journal of Statistical Software</em>, <strong>42</strong> (9), pp. 22. &lt;URL: <a href="http://www.jstatsoft.org/v42/i09/" class="uri">http://www.jstatsoft.org/v42/i09/</a>&gt;.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#inputs">Inputs</a></li>
      <li><a href="#additional-inputs">Additional Inputs</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#model">Model</a></li>
      <li><a href="#quantities-of-interest">Quantities of Interest</a></li>
      <li><a href="#output-values">Output Values</a></li>
      <li><a href="#see-also">See also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
