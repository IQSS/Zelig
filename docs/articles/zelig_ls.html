<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Least Squares Regression • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Least Squares Regression</h1>
            
            <h4 class="date">2017-06-06</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.1.90000</em></p>
<p>Least Squares Regression for Continuous Dependent Variables with <code>ls</code>.</p>
<p>Use least squares regression analysis to estimate the best linear predictor for the specified dependent variables.</p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">model =</span> <span class="st">"ls"</span>, <span class="dt">weights =</span> w, <span class="dt">data =</span> mydata)
x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)
s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
<p>For more details about the difference between Zelig’s reference classes and compatibility wrappers see the <a href="zelig5_vs_zelig4.html">Quickstart Vignette</a>.</p>
<p>The following examples typically use the compatibility wrappers.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="simple-first-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-first-differences" class="anchor"></a>Simple first differences</h3>
<p>Load Zelig and attach example data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Zelig)</code></pre></div>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(macro)</code></pre></div>
<p>Estimate model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(unem <span class="op">~</span><span class="st"> </span>gdp <span class="op">+</span><span class="st"> </span>capmob <span class="op">+</span><span class="st"> </span>trade, <span class="dt">model =</span> <span class="st">"ls"</span>, <span class="dt">data =</span> macro,
                <span class="dt">cite =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Summarize regression coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out1)</code></pre></div>
<pre><code>## Model: 
## 
## Call:
## z5$zelig(formula = unem ~ gdp + capmob + trade, data = macro)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.3008 -2.0768 -0.3187  1.9789  7.7715 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  6.181294   0.450572  13.719  &lt; 2e-16
## gdp         -0.323601   0.062820  -5.151 4.36e-07
## capmob       1.421939   0.166443   8.543 4.22e-16
## trade        0.019854   0.005606   3.542 0.000452
## 
## Residual standard error: 2.746 on 346 degrees of freedom
## Multiple R-squared:  0.2878, Adjusted R-squared:  0.2817 
## F-statistic: 46.61 on 3 and 346 DF,  p-value: &lt; 2.2e-16
## 
## Next step: Use 'setx' method</code></pre>
<p>Set explanatory variables to their default (mean/mode) values, with high (80th percentile) and low (20th percentile) values for the trade variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.high &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out1, <span class="dt">trade =</span> <span class="kw">quantile</span>(macro<span class="op">$</span>trade, <span class="fl">0.8</span>))
x.low &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out1, <span class="dt">trade =</span> <span class="kw">quantile</span>(macro<span class="op">$</span>trade, <span class="fl">0.2</span>))</code></pre></div>
<p>Simulate first differences for the effect of high versus low trade on GDP:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out1, <span class="dt">x =</span> x.high, <span class="dt">x1 =</span> x.low)

<span class="kw">summary</span>(s.out1)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##       mean        sd      50%     2.5%    97.5%
## 1 5.431973 0.1869131 5.430751 5.088196 5.798064
## pv
##          mean       sd      50%       2.5%    97.5%
## [1,] 5.467592 2.692446 5.409216 0.08244061 10.61921
## 
##  sim x1 :
##  -----
## ev
##       mean        sd      50%     2.5%    97.5%
## 1 4.601547 0.1806391 4.603683 4.260526 4.933739
## pv
##         mean       sd      50%       2.5%   97.5%
## [1,] 4.60397 2.735845 4.567535 -0.4539401 10.2838
## fd
##        mean        sd        50%      2.5%      97.5%
## 1 -0.830426 0.2246132 -0.8328681 -1.296609 -0.3645703</code></pre>
<p>Plot the simulated distributions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s.out1)</code></pre></div>
<p><img src="zelig_ls_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div id="categorical-variables-including-fixed-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#categorical-variables-including-fixed-effects" class="anchor"></a>Categorical variables, including fixed effects</h3>
<p>Estimate a model with fixed effects for each country (see for help with dummy variables). Note that you do not need to create dummy variables, as the program will automatically parse the unique values in the selected variable into discrete levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(unem <span class="op">~</span><span class="st"> </span>gdp <span class="op">+</span><span class="st"> </span>trade <span class="op">+</span><span class="st"> </span>capmob <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(country), <span class="dt">model =</span> <span class="st">"ls"</span>,
                <span class="dt">data =</span> macro, <span class="dt">cite =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Set values for the explanatory variables, using the default mean/mode values, with country set to the United States and Japan, respectively:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.US &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out2, <span class="dt">country =</span> <span class="st">"United States"</span>)
x.Japan &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out2, <span class="dt">country =</span> <span class="st">"Japan"</span>)</code></pre></div>
<p>Simulate quantities of interest:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out2, <span class="dt">x =</span> x.US, <span class="dt">x1 =</span> x.Japan)</code></pre></div>
<p>and plot the results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s.out2)</code></pre></div>
<p><img src="zelig_ls_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
</div>
<div id="model-definition" class="section level2">
<h2 class="hasAnchor">
<a href="#model-definition" class="anchor"></a>Model Definition</h2>
<ul>
<li>The <em>stochastic component</em> is described by a density with mean <span class="math inline">\(\mu_i\)</span> and the common variance <span class="math inline">\(\sigma^2\)</span>
</li>
</ul>
<p><span class="math display">\[
    Y_i \; \sim \; f(y_i \mid \mu_i, \sigma^2).
\]</span></p>
<ul>
<li>The <em>systematic component</em> models the conditional mean as</li>
</ul>
<p><span class="math display">\[
   \mu_i =  x_i \beta,
\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> is the vector of covariates, and <span class="math inline">\(\beta\)</span> is the vector of coefficients.</p>
<p>The least squares estimator is the best linear predictor of a dependent variable given <span class="math inline">\(x_i\)</span>, and minimizes the sum of squared residuals, <span class="math inline">\(\sum_{i=1}^n (Y_i-x_i \beta)^2\)</span>.</p>
</div>
<div id="quantities-of-interest-definition" class="section level2">
<h2 class="hasAnchor">
<a href="#quantities-of-interest-definition" class="anchor"></a>Quantities of Interest Definition</h2>
<ul>
<li>The expected value (<code>qi$ev</code>) is the mean of simulations from the stochastic component,</li>
</ul>
<p><span class="math display">\[
   E(Y) = x_i \beta,
\]</span></p>
<p>given a draw of <span class="math inline">\(\beta\)</span> from its sampling distribution.</p>
<ul>
<li>In conditional prediction models, the average expected treatment effect (<code>att.ev</code>) for the treatment group is</li>
</ul>
<p><span class="math display">\[
   \frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
           E[Y_i(t_i=0)] \right\},
\]</span></p>
<p>where <span class="math inline">\(t_i\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_i=1\)</span>) and control (<span class="math inline">\(t_i=0\)</span>) groups. Variation in the simulations are due to uncertainty in simulating <span class="math inline">\(E[Y_i(t_i=0)]\)</span>, the counterfactual expected value of <span class="math inline">\(Y_i\)</span> for observations in the treatment group, under the assumption that everything stays the same except that the treatment indicator is switched to :math: <span class="math inline">\(t_i=0\)</span>.</p>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The output of each Zelig function call contains useful information which you may view. For example, using the <code>z.out1</code> object we estimated above, then you may see the coefficients by using <code>get_coef</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out1<span class="op">$</span><span class="kw">get_coef</span>()</code></pre></div>
<pre><code>## [[1]]
## (Intercept)         gdp      capmob       trade 
##  6.18129445 -0.32360059  1.42193926  0.01985421</code></pre>
<p>or the variance-covariance matrix with <code>get_vcov</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out1<span class="op">$</span><span class="kw">get_vcov</span>()</code></pre></div>
<pre><code>## [[1]]
##              (Intercept)           gdp       capmob         trade
## (Intercept)  0.203014830 -1.582154e-02 1.679720e-02 -2.014899e-03
## gdp         -0.015821542  3.946360e-03 1.721017e-03  7.907613e-05
## capmob       0.016797200  1.721017e-03 2.770329e-02  4.025728e-05
## trade       -0.002014899  7.907613e-05 4.025728e-05  3.142207e-05</code></pre>
<p>For a default summary of information use either</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out1<span class="op">$</span><span class="kw">summarize</span>()</code></pre></div>
<pre><code>## Model: 
## 
## Call:
## z5$zelig(formula = unem ~ gdp + capmob + trade, data = macro)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.3008 -2.0768 -0.3187  1.9789  7.7715 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  6.181294   0.450572  13.719  &lt; 2e-16
## gdp         -0.323601   0.062820  -5.151 4.36e-07
## capmob       1.421939   0.166443   8.543 4.22e-16
## trade        0.019854   0.005606   3.542 0.000452
## 
## Residual standard error: 2.746 on 346 degrees of freedom
## Multiple R-squared:  0.2878, Adjusted R-squared:  0.2817 
## F-statistic: 46.61 on 3 and 346 DF,  p-value: &lt; 2.2e-16
## 
## Next step: Use 'setx' method</code></pre>
<p>or as we saw before using the wrapper, e.g. <code>summary(z.out1)</code>.</p>
<ul>
<li><p>From the <code><a href="../reference/zelig.html">zelig()</a></code> output object <code>z.out</code>, you may use the following ‘getter’ functions to extract:</p></li>
<li><p><code>get_pvalue</code> and <code>get_se</code>: p-values and standard errors, respectively.</p></li>
<li><p><code>get_residuals</code>: residuals.</p></li>
<li><p><code>get_fitted</code>: fitted values.</p></li>
<li><p><code>get_df_residual</code>: the residual degrees of freedom.</p></li>
<li><p><code>get_model_data</code>: the input data frame.</p></li>
<li><p>You can extract the entire original fitted model object with <code>from_zelig_model</code>. For example:</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ls.original &lt;-<span class="st"> </span><span class="kw"><a href="../reference/from_zelig_model.html">from_zelig_model</a></span>(z.out1)</code></pre></div>
<p>You can then use <code>summary</code> and the component selector <code>$</code> to extract:</p>
<ul>
<li>
<p><code>coefficients</code>: the parameter estimates with their associated standard errors, <span class="math inline">\(p\)</span>-values, and <span class="math inline">\(t\)</span>-statistics.</p>
<p><span class="math display">\[\hat{\beta} \; = \; \left(\sum_{i=1}^n x_i' x_i\right)^{-1} \sum x_i y_i\]</span></p>
</li>
<li>
<p><code>sigma</code>: the square root of the estimate variance of the random error <span class="math inline">\(e\)</span>:</p>
<p><span class="math display">\[\hat{\sigma} \; = \; \frac{\sum (Y_i-x_i\hat{\beta})^2}{n-k}\]</span></p>
</li>
<li>
<p><code>r.squared</code>: the fraction of the variance explained by the model:</p>
<p><span class="math display">\[R^2 \; = \; 1 - \frac{\sum (Y_i-x_i\hat{\beta})^2}{\sum (y_i -
              \bar{y})^2}\]</span></p>
</li>
<li><p><code>adj.r.squared</code>: the above <span class="math inline">\(R^2\)</span> statistic, penalizing for an increased number of explanatory variables.</p></li>
<li><p><code>cov.unscaled</code>: a <span class="math inline">\(k \times k\)</span> matrix of unscaled covariances.</p></li>
</ul>
<p>For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ls.original &lt;-<span class="st"> </span><span class="kw"><a href="../reference/from_zelig_model.html">from_zelig_model</a></span>(z.out1)
<span class="kw">summary</span>(ls.original)<span class="op">$</span>adj.r.squared</code></pre></div>
<pre><code>## [1] 0.2816635</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#model-definition">Model Definition</a></li>
      <li><a href="#quantities-of-interest-definition">Quantities of Interest Definition</a></li>
      <li><a href="#output-values">Output Values</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
