<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Probit Bayesian Regression • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Probit Bayesian Regression</h1>
            
            <h4 class="date">2017-06-06</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.1.90000</em></p>
<hr>
<p>Bayesian Probit Regression with <code>probit.bayes</code>.</p>
<p>Use the probit regression model for model binary dependent variables specified as a function of a set of explanatory variables. The model is estimated using a Gibbs sampler. For other models suitable for binary response variables, see Bayesian logistic regression, maximum likelihood logit regression, and maximum likelihood probit regression.</p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">model =</span> <span class="st">"probit.bayes"</span>, <span class="dt">weights =</span> w,
               <span class="dt">data =</span> mydata)
x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)
s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
</div>
<div id="additional-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-inputs" class="anchor"></a>Additional Inputs</h2>
<p>Using the following arguments to monitor the Markov chains:</p>
<ul>
<li><p><code>burnin</code>: number of the initial MCMC iterations to be discarded (defaults to 1,000).</p></li>
<li><p><code>mcmc</code>: number of the MCMC iterations after burnin (defaults to 10,000).</p></li>
<li><p><code>thin</code>: thinning interval for the Markov chain. Only every <code>thin</code>-th draw from the Markov chain is kept. The value of <code>mcmc</code> must be divisible by this value. The default value is 1.</p></li>
<li><p><code>verbose</code>: defaults to FALSE. If <code>TRUE</code>, the progress of the sampler (every <span class="math inline">\(10\%\)</span>) is printed to the screen.</p></li>
<li><p><code>seed</code>: seed for the random number generator. The default is <code>NA</code> which corresponds to a random seed of 12345.</p></li>
<li><p><code>beta.start</code>: starting values for the Markov chain, either a scalar or vector with length equal to the number of estimated coefficients. The default is <code>NA</code>, such that the maximum likelihood estimates are used as the starting values.</p></li>
</ul>
<p>Use the following parameters to specify the model’s priors:</p>
<ul>
<li><p><code>b0</code>: prior mean for the coefficients, either a numeric vector or a scalar. If a scalar value, that value will be the prior mean for all the coefficients. The default is 0.</p></li>
<li><p><code>B0</code>: prior precision parameter for the coefficients, either a square matrix (with the dimensions equal to the number of the coefficients) or a scalar. If a scalar value, that value times an identity matrix will be the prior precision parameter. The default is 0, which leads to an improper prior.</p></li>
</ul>
<p>Use the following arguments to specify optional output for the model:</p>
<ul>
<li>
<code>bayes.resid</code>: defaults to FALSE. If TRUE, the latent Bayesian residuals for all observations are returned. Alternatively, users can specify a vector of observations for which the latent residuals should be returned.</li>
</ul>
<p>Zelig users may wish to refer to <code>help(MCMCprobit)</code> for more information.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="basic-example" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-example" class="anchor"></a>Basic Example</h3>
<p>Attaching the sample dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(turnout)</code></pre></div>
<p>Estimating the probit regression using <code>probit.bayes</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(vote <span class="op">~</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>educate, <span class="dt">model =</span> <span class="st">"probit.bayes"</span>,
               <span class="dt">data =</span> turnout, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Ben Goodrich, and Ying Lu. 2013.
##   probit-bayes: Bayesian Probit Regression for Dichotomous Dependent Variables
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<p>You can check for convergence before summarizing the estimates with three diagnostic tests. See the section <a href="diagnostics.html">Diagnostics for Zelig Models</a> for examples of the output with interpretation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out<span class="op">$</span><span class="kw">geweke.diag</span>()
z.out<span class="op">$</span><span class="kw">heidel.diag</span>()
z.out<span class="op">$</span><span class="kw">raftery.diag</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out)</code></pre></div>
<pre><code>## Model: 
## 
## Iterations = 1001:11000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                 Mean       SD  Naive SE Time-series SE
## (Intercept) -0.73272 0.128052 1.281e-03       0.002140
## racewhite    0.29892 0.084795 8.480e-04       0.001369
## educate      0.09769 0.009571 9.571e-05       0.000169
## 
## 2. Quantiles for each variable:
## 
##                 2.5%      25%      50%     75%   97.5%
## (Intercept) -0.98540 -0.81888 -0.73254 -0.6455 -0.4826
## racewhite    0.13589  0.24104  0.29829  0.3562  0.4671
## educate      0.07909  0.09124  0.09756  0.1041  0.1166
## 
## Next step: Use 'setx' method</code></pre>
<p>Setting values for the explanatory variables to their sample averages:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)</code></pre></div>
<p>Simulating quantities of interest from the posterior distribution given: <code>x.out</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s.out1)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##           mean         sd       50%      2.5%     97.5%
## [1,] 0.7717432 0.01031008 0.7718507 0.7510289 0.7914853
## pv
##          0     1
## [1,] 2.253 7.747</code></pre>
</div>
<div id="simulating-first-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-first-differences" class="anchor"></a>Simulating First Differences</h3>
<p>Estimating the first difference (and risk ratio) in individual’s probability of voting when education is set to be low (25th percentile) versus high (75th percentile) while all the other variables are held at their default values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.high &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out, <span class="dt">educate =</span> <span class="kw">quantile</span>(turnout<span class="op">$</span>educate, <span class="dt">prob =</span> <span class="fl">0.75</span>))
x.low &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out, <span class="dt">educate =</span> <span class="kw">quantile</span>(turnout<span class="op">$</span>educate, <span class="dt">prob =</span> <span class="fl">0.25</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.high, <span class="dt">x1 =</span> x.low)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s.out2)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##           mean         sd      50%     2.5%     97.5%
## [1,] 0.8246237 0.01046197 0.824774 0.803333 0.8440976
## pv
##         0    1
## [1,] 1.77 8.23
## 
##  sim x1 :
##  -----
## ev
##           mean         sd       50%      2.5%    97.5%
## [1,] 0.7063475 0.01291402 0.7064286 0.6805591 0.731263
## pv
##         0    1
## [1,] 2.99 7.01
## fd
##            mean         sd        50%     2.5%       97.5%
## [1,] -0.1182762 0.01163816 -0.1181972 -0.14144 -0.09569404</code></pre>
</div>
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>Let <span class="math inline">\(Y_{i}\)</span> be the binary dependent variable for observation <span class="math inline">\(i\)</span> which takes the value of either 0 or 1.</p>
<ul>
<li>The <em>stochastic component</em> is given by</li>
</ul>
$$
<span class="math display">\[\begin{aligned}
        Y_{i}  &amp;  \sim &amp; \textrm{Bernoulli}(\pi_{i})\\
      &amp;  = &amp; \pi_{i}^{Y_{i}}(1-\pi_{i})^{1-Y_{i}},\end{aligned}\]</span>
<p>where <span class="math inline">\(\pi_{i}=\Pr(Y_{i}=1)\)</span>.</p>
<ul>
<li>The <em>systematic component</em> is given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \pi_{i}= \Phi(x_i \beta),\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\Phi(\cdot)\)</span> is the cumulative density function of the standard Normal distribution with mean 0 and variance 1, <span class="math inline">\(x_{i}\)</span> is the vector of <span class="math inline">\(k\)</span> explanatory variables for observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(\beta\)</span> is the vector of coefficients.</p>
<ul>
<li>The <em>prior</em> for <span class="math inline">\(\beta\)</span> is given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \beta \sim \textrm{Normal}_k \left(  b_{0}, B_{0}^{-1} \right)
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(b_{0}\)</span> is the vector of means for the <span class="math inline">\(k\)</span> explanatory variables and <span class="math inline">\(B_{0}\)</span> is the <span class="math inline">\(k \times k\)</span> precision matrix (the inverse of a variance-covariance matrix).</p>
</div>
<div id="quantities-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#quantities-of-interest" class="anchor"></a>Quantities of Interest</h2>
<ul>
<li>The expected values (<code>qi$ev</code>) for the probit model are the predicted probability of a success:</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        E(Y \mid X) = \pi_{i}= \Phi(x_i \beta),
    \end{aligned}
\]</span></p>
<p>given the posterior draws of <span class="math inline">\(\beta\)</span> from the MCMC iterations.</p>
<ul>
<li><p>The predicted values (<code>qi$pr</code>) are draws from the Bernoulli distribution with mean equal to the simulated expected value <span class="math inline">\(\pi_{i}\)</span>.</p></li>
<li><p>The first difference (<code>qi$fd</code>) for the probit model is defined as</p></li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \text{FD}=\Pr(Y=1\mid X_{1})-\Pr(Y=1\mid X).
    \end{aligned}
\]</span></p>
<ul>
<li>The risk ratio (<code>qi$rr</code>)is defined as</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \text{RR}=\Pr(Y=1\mid X_{1})\ /\ \Pr(Y=1\mid X).
    \end{aligned}
\]</span></p>
<ul>
<li>In conditional prediction models, the average expected treatment effect (<code>qi$att.ev</code>) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \frac{1}{\sum t_{i}}\sum_{i:t_{i}=1}[Y_{i}(t_{i}=1)-E[Y_{i}(t_{i}=0)]],
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(t_{i}\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_{i}=1\)</span>) and control (<span class="math inline">\(t_{i}=0\)</span>) groups.</p>
<ul>
<li>In conditional prediction models, the average predicted treatment effect (<code>qi$att.pr</code>) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \frac{1}{\sum t_{i}}\sum_{i:t_{i}=1}[Y_{i}(t_{i}=1)-\widehat{Y_{i}(t_{i}=0)}],
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(t_{i}\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_{i}=1\)</span>) and control (<span class="math inline">\(t_{i}=0\)</span>) groups.</p>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The output of each Zelig command contains useful information which you may view. For example, if you run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">model =</span> <span class="st">"probit.bayes"</span>, data)</code></pre></div>
<p>then you may examine the available information in <code>z.out</code> by using <code>names(z.out)</code>, see the draws from the posterior distribution of the <code>coefficients</code> by using <code>z.out$coefficients</code>, and view a default summary of information through <code>summary(z.out)</code>. Other elements available through the <code>$</code> operator are listed below.</p>
<ul>
<li><p>From the <code><a href="../reference/zelig.html">zelig()</a></code> output object <code>z.out</code>, you may extract:</p></li>
<li><p><code>coefficients</code>: draws from the posterior distributions of the estimated parameters.</p></li>
<li><p>zelig.data: the input data frame if save.data = TRUE.</p></li>
<li><p><code>bayes.residuals</code>: When <code>bayes.residual</code> is <code>TRUE</code> or a set of observation numbers is given, this object contains the posterior draws of the latent Bayesian residuals of all the observations or the observations specified by the user.</p></li>
<li><p><code>seed</code>: the random seed used in the model.</p></li>
<li><p>From the <code><a href="../reference/sim.html">sim()</a></code> output object <code>s.out</code>:</p></li>
<li><p><code>qi$ev</code>: the simulated expected values (probabilities) for the specified values of <code>x</code>.</p></li>
<li><p><code>qi$pr</code>: the simulated predicted values for the specified values of <code>x</code>.</p></li>
<li><p><code>qi$fd</code>: the simulated first difference in the expected values for the values specified in <code>x</code> and <code>x1</code>.</p></li>
<li><p><code>qi$rr</code>: the simulated risk ratio for the expected values simulated from <code>x</code> and <code>x1</code>.</p></li>
<li><p><code>qi$att.ev</code>: the simulated average expected treatment effect for the treated from conditional prediction models.</p></li>
<li><p><code>qi$att.pr</code>: the simulated average predicted treatment effect for the treated from conditional prediction models.</p></li>
</ul>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>Bayesian probit regression is part of the MCMCpack library by Andrew D. Martin and Kevin M. Quinn . The convergence diagnostics are part of the CODA library by Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines.</p>
<p>Martin AD, Quinn KM and Park JH (2011). “MCMCpack: Markov Chain Monte Carlo in R.” <em>Journal of Statistical Software</em>, <strong>42</strong> (9), pp. 22. &lt;URL: <a href="http://www.jstatsoft.org/v42/i09/" class="uri">http://www.jstatsoft.org/v42/i09/</a>&gt;.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#additional-inputs">Additional Inputs</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#model">Model</a></li>
      <li><a href="#quantities-of-interest">Quantities of Interest</a></li>
      <li><a href="#output-values">Output Values</a></li>
      <li><a href="#see-also">See also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
