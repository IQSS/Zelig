<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Poisson Bayes • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Poisson Bayes</h1>
            
            <h4 class="date">2017-06-06</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.1.90000</em></p>
<hr>
<p>Bayesian Poisson Regression with <code>poisson.bayes</code>.</p>
<p>Use the Poisson regression model if the observations of your dependent variable represents the number of independent events that occur during a fixed period of time. The model is fit using a random walk Metropolis algorithm. For a maximum-likelihood estimation of this model see <a href="zelig_poisson.html">poisson</a>.</p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">model =</span> <span class="st">"poisson.bayes"</span>,
               <span class="dt">weights =</span> w, <span class="dt">data =</span> mydata)
x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)
s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
</div>
<div id="additional-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-inputs" class="anchor"></a>Additional Inputs</h2>
<p>Use the following argument to monitor the Markov chain:</p>
<ul>
<li><p><code>burnin</code>: number of the initial MCMC iterations to be discarded (defaults to 1,000).</p></li>
<li><p><code>mcmc</code>: number of the MCMC iterations after burnin (defaults to 10,000).</p></li>
<li><p><code>thin</code>: thinning interval for the Markov chain. Only every <code>thin</code>-th draw from the Markov chain is kept. The value of <code>mcmc</code> must be divisible by this value. The default value is 1.</p></li>
<li><p><code>tune</code>: Metropolis tuning parameter, either a positive scalar or a vector of length <span class="math inline">\(k\)</span>, where <span class="math inline">\(k\)</span> is the number of coefficients. The tuning parameter should be set such that the acceptance rate of the Metropolis algorithm is satisfactory (typically between 0.20 and 0.5). The default value is 1.1.</p></li>
<li><p><code>verbose</code>: default to FALSE. If <code>TRUE</code>, the progress of the sampler (every <span class="math inline">\(10\%\)</span>) is printed to the screen.</p></li>
<li><p><code>seed</code>: seed for the random number generator. The default is <code>NA</code> which corresponds to a random seed of 12345.</p></li>
<li><p><code>beta.start</code>: starting values for the Markov chain, either a scalar or vector with length equal to the number of estimated coefficients. The default is <code>NA</code>, such that the maximum likelihood estimates are used as the starting values.</p></li>
</ul>
<p>Use the following parameters to specify the model’s priors:</p>
<ul>
<li><p><code>b0</code>: prior mean for the coefficients, either a numeric vector or a scalar. If a scalar, that value will be the prior mean for all the coefficients. The default is 0.</p></li>
<li><p><code>B0</code>: prior precision parameter for the coefficients, either a square matrix (with the dimensions equal to the number of the coefficients) or a scalar. If a scalar, that value times an identity matrix will be the prior precision parameter. The default is 0, which leads to an improper prior.</p></li>
</ul>
<p>Zelig users may wish to refer to <code>help(MCMCpoisson)</code> for more information.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="basic-example" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-example" class="anchor"></a>Basic Example</h3>
<p>Attaching the sample dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(sanction)</code></pre></div>
<p>Estimating the Poisson regression using <code>poisson.bayes</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(num <span class="op">~</span><span class="st"> </span>target <span class="op">+</span><span class="st"> </span>coop, <span class="dt">model =</span> <span class="st">"poisson.bayes"</span>,
               <span class="dt">data =</span> sanction, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Ben Goodrich, and Ying Lu. 2013.
##   poisson-bayes: Bayesian Poisson Regression
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<p>You can check for convergence before summarizing the estimates with three diagnostic tests. See the section <a href="diagnostics.html">Diagnostics for Zelig Models</a> for examples of the output with interpretation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out<span class="op">$</span><span class="kw">geweke.diag</span>()
z.out<span class="op">$</span><span class="kw">heidel.diag</span>()
z.out<span class="op">$</span><span class="kw">raftery.diag</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out)</code></pre></div>
<pre><code>## Model: 
## 
## Iterations = 1001:11000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                 Mean      SD  Naive SE Time-series SE
## (Intercept) -0.97979 0.17464 0.0017464       0.005591
## target      -0.01762 0.05667 0.0005667       0.001885
## coop         1.21090 0.04702 0.0004702       0.001520
## 
## 2. Quantiles for each variable:
## 
##                2.5%      25%      50%      75%    97.5%
## (Intercept) -1.3310 -1.09338 -0.97766 -0.86116 -0.64556
## target      -0.1299 -0.05657 -0.01953  0.02025  0.09443
## coop         1.1208  1.17889  1.21008  1.24150  1.30664
## 
## Next step: Use 'setx' method</code></pre>
<p>Setting values for the explanatory variables to their sample averages:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)</code></pre></div>
<p>Simulating quantities of interest from the posterior distribution given <code>x.out</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s.out1)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##          mean        sd      50%     2.5%    97.5%
## [1,] 3.235291 0.2375714 3.234844 2.777139 3.704941
## pv
##        mean       sd 50% 2.5% 97.5%
## [1,] 3.2301 1.795014   3    0     7</code></pre>
</div>
<div id="simulating-first-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-first-differences" class="anchor"></a>Simulating First Differences</h3>
<p>Estimating the first difference in the number of countries imposing sanctions when the number of targets is set to be its maximum versus its minimum :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.max &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out, <span class="dt">target =</span> <span class="kw">max</span>(sanction<span class="op">$</span>target))
x.min &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out, <span class="dt">target =</span> <span class="kw">min</span>(sanction<span class="op">$</span>target))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.max, <span class="dt">x1 =</span> x.min)
<span class="kw">summary</span>(s.out2)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##          mean        sd      50%     2.5%    97.5%
## [1,] 3.191614 0.2936585 3.183013 2.642371 3.803733
## pv
##        mean       sd 50% 2.5% 97.5%
## [1,] 3.2136 1.798638   3    0     7
## 
##  sim x1 :
##  -----
## ev
##          mean        sd      50%     2.5%    97.5%
## [1,] 3.306252 0.3059862 3.300095 2.729466 3.944022
## pv
##        mean       sd 50% 2.5% 97.5%
## [1,] 3.3323 1.846515   3    0     7
## fd
##           mean        sd       50%       2.5%     97.5%
## [1,] 0.1146376 0.3671544 0.1265036 -0.6072035 0.8342282</code></pre>
</div>
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>Let <span class="math inline">\(Y_{i}\)</span> be the number of independent events that occur during a fixed time period.</p>
<ul>
<li>The <em>stochastic component</em> is given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        Y_{i}  &amp;  \sim &amp; \textrm{Poisson}(\lambda_i)
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\lambda_i\)</span> is the mean and variance parameter.</p>
<ul>
<li>The <em>systematic component</em> is given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \lambda_{i}= \exp(x_{i} \beta)
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(x_{i}\)</span> is the vector of <span class="math inline">\(k\)</span> explanatory variables for observation <span class="math inline">\(i\)</span> and <span class="math inline">\(\beta\)</span> is the vector of coefficients.</p>
<ul>
<li>The <em>prior</em> for <span class="math inline">\(\beta\)</span> is given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \beta \sim \textrm{Normal}_k \left(  b_{0},B_{0}^{-1}\right)
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(b_{0}\)</span> is the vector of means for the <span class="math inline">\(k\)</span> explanatory variables and <span class="math inline">\(B_{0}\)</span> is the <span class="math inline">\(k \times k\)</span> precision matrix (the inverse of a variance-covariance matrix).</p>
</div>
<div id="quantities-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#quantities-of-interest" class="anchor"></a>Quantities of Interest</h2>
<ul>
<li>The expected values (<code>qi$ev</code>) for the Poisson model are calculated as following:</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        E(Y\mid X) = \lambda_i = \exp(x_i \beta),
    \end{aligned}
\]</span></p>
<p>given the posterior draws of <span class="math inline">\(\beta\)</span> based on the MCMC iterations.</p>
<ul>
<li><p>The predicted values (<code>qi$pr</code>) are draws from the Poisson distribution with parameter <span class="math inline">\(\lambda_i\)</span>.</p></li>
<li><p>The first difference (<code>qi$fd</code>) for the Poisson model is defined as</p></li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \text{FD}=E(Y\mid X_{1})-E(Y\mid X).
    \end{aligned}
\]</span></p>
<ul>
<li>In conditional prediction models, the average expected treatment effect (<code>qi$att.ev</code>) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \frac{1}{\sum_{i=1}^n t_{i}}\sum_{i:t_{i}=1}\{Y_{i}(t_{i}=1)-E[Y_{i}(t_{i}=0)]\},
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(t_{i}\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_{i}=1\)</span>) and control (<span class="math inline">\(t_{i}=0\)</span>) groups.</p>
<ul>
<li>In conditional prediction models, the average predicted treatment effect (<code>qi$att.pr</code>) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \frac{1}{\sum_{i=1}^n t_{i}}\sum_{i:t_{i}=1}[Y_{i}(t_{i}=1)-\widehat{Y_{i}(t_{i}=0)}],
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(t_{i}\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_{i}=1\)</span>) and control (<span class="math inline">\(t_{i}=0\)</span>) groups.</p>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The output of each Zelig command contains useful information which you may view. For example, if you run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">model =</span> <span class="st">"poisson.bayes"</span>, data)</code></pre></div>
<p>you may examine the available information in <code>z.out</code> by using <code>names(z.out)</code>, see the draws from the posterior distribution of the <code>coefficients</code> by using <code>z.out$coefficients</code>, and view a default summary of information through <code>summary(z.out)</code>. Other elements available through the <code>$</code> operator are listed below.</p>
<ul>
<li><p>From the <code><a href="../reference/zelig.html">zelig()</a></code> output object <code>z.out</code>, you may extract:</p></li>
<li><p><code>coefficients</code>: draws from the posterior distributions of the estimated parameters.</p></li>
<li><p><code>zelig.data</code>: the input data frame if save.data = TRUE.</p></li>
<li><p><code>seed</code>: the random seed used in the model.</p></li>
<li><p>From the <code><a href="../reference/sim.html">sim()</a></code> output object <code>s.out</code>:</p></li>
<li><p><code>qi$ev</code>: the simulated expected values for the specified values of <code>x</code>.</p></li>
<li><p><code>qi$pr</code>: the simulated predicted values for the specified values of <code>x</code>.</p></li>
<li><p><code>qi$fd</code>: the simulated first difference in the expected values for the values specified in <code>x</code> and <code>x1</code>.</p></li>
<li><p><code>qi$att.ev</code>: the simulated average expected treatment effect for the treated from conditional prediction models.</p></li>
<li><p><code>qi$att.pr</code>: the simulated average predicted treatment effect for the treated from conditional prediction models.</p></li>
</ul>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>Bayesian poisson regression is part of the MCMCpack library by Andrew D. Martin and Kevin M. Quinn . The convergence diagnostics are part of the CODA library by Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines.</p>
<p>Martin AD, Quinn KM and Park JH (2011). “MCMCpack: Markov Chain Monte Carlo in R.” <em>Journal of Statistical Software</em>, <strong>42</strong> (9), pp. 22. &lt;URL: <a href="http://www.jstatsoft.org/v42/i09/" class="uri">http://www.jstatsoft.org/v42/i09/</a>&gt;.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#additional-inputs">Additional Inputs</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#model">Model</a></li>
      <li><a href="#quantities-of-interest">Quantities of Interest</a></li>
      <li><a href="#output-values">Output Values</a></li>
      <li><a href="#see-also">See also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
