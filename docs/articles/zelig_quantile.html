<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quantile Regression • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Quantile Regression</h1>
            
            <h4 class="date">2017-05-08</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.0.90000</em></p>
<hr>
<p>Quantile Regression for Continuous Dependent Variables with <code>rq</code>.</p>
<p>Use a linear programming implementation of quantile regression to estimate a linear predictor of the <span class="math inline">\(\tau\)</span> th conditional quantile of the population.</p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z5 &lt;-<span class="st"> </span>zquantile<span class="op">$</span><span class="kw">new</span>()
z5<span class="op">$</span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">weights =</span> w, <span class="dt">data =</span> mydata, <span class="dt">tau =</span> <span class="fl">0.5</span>)
z5<span class="op">$</span><span class="kw"><a href="../reference/setx.html">setx</a></span>()
z5<span class="op">$</span><span class="kw"><a href="../reference/sim.html">sim</a></span>()</code></pre></div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">model =</span> <span class="st">"rq"</span>, <span class="dt">weights =</span> w,
               <span class="dt">data =</span> mydata, <span class="dt">tau =</span> <span class="fl">0.5</span>)
x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)
s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
</div>
<div id="additional-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-inputs" class="anchor"></a>Additional Inputs</h2>
<p>In addition to the standard inputs, <code><a href="../reference/zelig.html">zelig()</a></code> takes the following additional options for quantile regression:</p>
<ul>
<li><p><code>tau</code>: defaults to 0.5. Specifies the conditional quantile(s) that will be estimated. 0.5 corresponds to estimating the conditional median, 0.25 and 0.75 correspond to the conditional quartiles, etc. tau vectors with length greater than 1 are not currently supported. If tau is set outside of the interval <span class="math inline">\([0,1]\)</span>, zelig returns the solution for all possible conditional quantiles given the data, but does not support inference on this fit (setx and sim will fail).</p></li>
<li><p><code>se</code>: a string value that defaults to “nid”. Specifies the method by which the covariance matrix of coefficients is estimated during the sim stage of analysis. se can take the following values, which are passed to the summary.rq function from the quantreg package. These descriptions are copied from the summary.rq documentation.</p></li>
<li><p><code>"iid"</code> which presumes that the errors are iid and computes an estimate of the asymptotic covariance matrix as in KB(1978).</p></li>
<li><p><code>"nid"</code> which presumes local (in tau) linearity (in x) of the the conditional quantile functions and computes a Huber sandwich estimate using a local estimate of the sparsity.</p></li>
<li><p><code>"ker"</code> which uses a kernel estimate of the sandwich as proposed by Powell(1990).</p></li>
<li><p><code>...</code>: additional options passed to rq when fitting the model. See documentation for rq in the quantreg package for more information.</p></li>
</ul>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="basic-example-with-first-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-example-with-first-differences" class="anchor"></a>Basic Example with First Differences</h3>
<p>Attach sample data, in this case a dataset pertaining to the efficiency of plants that convert ammonia to nitric acid. The dependent variable, stack.loss, is 10 times the percentage of ammonia that escaped unconverted:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(stackloss)</code></pre></div>
<p>Estimate model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(stack.loss <span class="op">~</span><span class="st"> </span>Air.Flow <span class="op">+</span><span class="st"> </span>Water.Temp <span class="op">+</span><span class="st"> </span>Acid.Conc.,
                <span class="dt">model =</span> <span class="st">"rq"</span>, <span class="dt">data =</span> stackloss,
                <span class="dt">tau =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Alexander D'Amour. 2008.
##   quantile: Quantile Regression for Continuous Dependent Variables
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<p>Summarize regression coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out1)</code></pre></div>
<pre><code>## Model: 
## 
## Call: z5$zelig(formula = stack.loss ~ Air.Flow + Water.Temp + Acid.Conc., 
##     data = stackloss, tau = 0.5)
## 
## tau: [1] 0.5
## 
## Coefficients:
##             coefficients lower bd  upper bd 
## (Intercept) -39.68986    -41.61973 -29.67754
## Air.Flow      0.83188      0.51278   1.14117
## Water.Temp    0.57391      0.32182   1.41090
## Acid.Conc.   -0.06087     -0.21348  -0.02891
## Next step: Use 'setx' method</code></pre>
<p>Set explanatory variables to their default (mean/mode) values, with high (80th percentile) and low (20th percentile) values for the water temperature variable (the variable that indiates the temperature of water in the plant’s cooling coils):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.high &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out1, <span class="dt">Water.Temp =</span> <span class="kw">quantile</span>(stackloss<span class="op">$</span>Water.Temp, <span class="fl">0.8</span>))
x.low &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out1, <span class="dt">Water.Temp =</span> <span class="kw">quantile</span>(stackloss<span class="op">$</span>Water.Temp, <span class="fl">0.2</span>))</code></pre></div>
<p>Generate first differences for the effect of high versus low water temperature on stack loss:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out1, <span class="dt">x =</span> x.high, <span class="dt">x1 =</span> x.low)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s.out1)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##       mean       sd      50%    2.5%    97.5%
## 1 19.14363 1.570405 19.17741 15.9367 22.12099
## pv
##       mean       sd      50%     2.5%    97.5%
## 1 19.10866 1.825049 19.14511 15.43394 22.74148
## 
##  sim x1 :
##  -----
## ev
##      mean       sd      50%     2.5%   97.5%
## 1 15.6785 1.147777 15.69558 13.40625 17.8889
## pv
##       mean       sd      50%     2.5%   97.5%
## 1 15.70636 1.296457 15.73216 13.23153 18.2829
## fd
##        mean       sd       50%      2.5%     97.5%
## 1 -3.465124 2.087278 -3.489512 -7.570721 0.7230336</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s.out1)</code></pre></div>
<div class="figure">
<img src="zelig_quantile_files/figure-html/Zelig-quantile1-1.png" alt="Graphs of Quantities of Interest for Quantile Regression" width="672"><p class="caption">
Graphs of Quantities of Interest for Quantile Regression
</p>
</div>
</div>
<div id="using-dummy-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#using-dummy-variables" class="anchor"></a>Using Dummy Variables</h3>
<p>We can estimate a model of unemployment as a function of macroeconomic indicators and fixed effects for each country (see for help with dummy variables). Note that you do not need to create dummy variables, as the program will automatically parse the unique values in the selected variable into discrete levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(macro)
z.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(unem <span class="op">~</span><span class="st"> </span>gdp <span class="op">+</span><span class="st"> </span>trade <span class="op">+</span><span class="st"> </span>capmob <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(country),
                <span class="dt">model =</span> <span class="st">"rq"</span>, <span class="dt">tau =</span> <span class="fl">0.5</span>,
                <span class="dt">data =</span> macro)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Alexander D'Amour. 2008.
##   quantile: Quantile Regression for Continuous Dependent Variables
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<p>Set values for the explanatory variables, using the default mean/mode values, with country set to the United States and Japan, respectively:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.US &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out2, <span class="dt">country =</span> <span class="st">"United States"</span>)
x.Japan &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out2, <span class="dt">country =</span> <span class="st">"Japan"</span>)</code></pre></div>
<p>Simulate quantities of interest:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out2, <span class="dt">x =</span> x.US, <span class="dt">x1 =</span> x.Japan)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s.out2)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##       mean        sd      50%    2.5%    97.5%
## 1 11.60458 0.6092805 11.58133 10.4415 12.76068
## pv
##       mean       sd     50%     2.5%    97.5%
## 1 11.60311 0.609773 11.5698 10.43624 12.76432
## 
##  sim x1 :
##  -----
## ev
##       mean        sd      50%     2.5%    97.5%
## 1 6.854616 0.4038854 6.849454 6.084071 7.646943
## pv
##       mean        sd     50%     2.5%    97.5%
## 1 6.854618 0.4035154 6.84879 6.087191 7.649128
## fd
##        mean        sd       50%      2.5%     97.5%
## 1 -4.749969 0.4232467 -4.746332 -5.561712 -3.946614</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s.out2)</code></pre></div>
<div class="figure">
<img src="zelig_quantile_files/figure-html/Zelig-quantile2-1.png" alt="Graphs of Quantities of Interest for Quantile Regression" width="672"><p class="caption">
Graphs of Quantities of Interest for Quantile Regression
</p>
</div>
</div>
<div id="estimating-multiple-quantiles" class="section level3">
<h3 class="hasAnchor">
<a href="#estimating-multiple-quantiles" class="anchor"></a>Estimating Multiple Quantiles</h3>
<p>Using the Engel dataset (from the <code>quantreg</code> package) on food expenditure as a function of income, we can use the “quantile” model to estimate multiple conditional quantiles:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(engel, <span class="dt">package=</span><span class="st">"quantreg"</span>)
z.out3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(foodexp <span class="op">~</span><span class="st"> </span>income, <span class="dt">model =</span> <span class="st">"rq"</span>,
                <span class="dt">tau =</span> <span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="dt">by =</span> <span class="fl">0.1</span>), <span class="dt">data =</span> engel)</code></pre></div>
<p>We can summarize the coefficient fits, or plot them to compare them to the least squares conditional mean estimator.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out3)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">summary</span>(z.out3))</code></pre></div>
<p>Set the value of income to the top quartile and the bottom quartile of the income distribution for each fit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.bottom &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out3, <span class="dt">income =</span> <span class="kw">quantile</span>(engel<span class="op">$</span>income, <span class="fl">0.25</span>))
x.top &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out3, <span class="dt">income =</span> <span class="kw">quantile</span>(engel<span class="op">$</span>income, <span class="fl">0.75</span>))</code></pre></div>
<p>Simulate quantities of interest for each fit simultaneously:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out3, <span class="dt">x =</span> x.bottom, <span class="dt">x1 =</span> x.top)</code></pre></div>
<p>Summary</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s.out3)</code></pre></div>
</div>
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>The quantile estimator is best introduced by considering the sample median estimator and comparing it to the sample mean estimator. To find the mean of a sample, we solve for the quantity <span class="math inline">\(\mu\)</span> which minimizes the sum squared residuals:</p>
<p><span class="math display">\[
    \begin{aligned}
        \mu &amp;=&amp; \arg\min_\mu \sum_i (y_i-\mu)^2\end{aligned}
\]</span></p>
<p>Estimating a quantile is similar, but we solve for <span class="math inline">\(\xi\)</span> which minimizes the sum absolute residuals:</p>
<p><span class="math display">\[
    \begin{aligned}
        \xi &amp;=&amp; \arg\min_\xi \sum_i |y_i-\xi|
    \end{aligned}
\]</span></p>
<p>One can confirm the equivalence of these optimization problems and the standard mean and median operators by taking the derivative with respect to the argument and setting it to zero.</p>
<p>The relationship between quantile regression and ordinary least squares regression is analogous to the relationship between the sample median and the sample mean, except we are now solving for the conditional median or conditional mean given covariates and a linear functional form. The optimization problems for the sample mean and median are then easily generalized to optimization problems for estimating <em>conditional</em> means or medians by replacing <span class="math inline">\(\mu\)</span> or <span class="math inline">\(\xi\)</span> with a linear combination of covariates <span class="math inline">\(X'\beta\)</span>:</p>
<p><span class="math display">\[
    \begin{aligned}
        \hat\beta_\mathrm{mean} &amp;=&amp; \arg\min_\beta \sum_i (Y_i-X_i'\beta)^2 \nonumber \\
       \hat\beta_\mathrm{median} &amp;=&amp; \arg\min_\beta \sum_i |Y_i-X_i'\beta| \label{median}
    \end{aligned}
\]</span></p>
<p>Equation [median] can be generalized to provide any quantile of the conditional distribution, not just the median. We do this by weighting the aboslute value function asymmetrically in proportion to the requested <span class="math inline">\(\tau\)</span> th quantile:</p>
<p><span class="math display">\[
    \begin{aligned}
        \hat\beta_{\tau} &amp;=&amp; \arg\max_\beta \sum \rho(Y_i-X_i'\beta) \label{beta}\\
       \rho &amp;=&amp; \tau(1-I(Y-X_i'\beta &gt; 0)) + (1-\tau)I(Y-X_i'\beta &gt; 0) \nonumber
    \end{aligned}
\]</span></p>
<p>We call the asymmetric absolute value function a “check function”. This optimization problem has no closed form solution and is solved via linear programming.</p>
<p>Equation [beta] now lets us define a conditional quantile estimator. Suppose that for a given set of covariates <span class="math inline">\(x\)</span>, the response variable <span class="math inline">\(Y\)</span> has as true conditional probability distribution <span class="math inline">\(f(\theta | x)\)</span> where <span class="math inline">\(f\)</span> can be any probability density function parametrized by a vector of parameters <span class="math inline">\(\theta\)</span>. This density function defines a value <span class="math inline">\(Q_\tau(\theta|x)\)</span>, the true <span class="math inline">\(\tau\)</span> th population quantile given <span class="math inline">\(x\)</span>. We can write our conditional quantile estimator <span class="math inline">\(\hat Q_\tau(\theta|x)\)</span> as:</p>
<p><span class="math display">\[
    \begin{aligned}
        \hat Q_\tau(\theta|x) &amp;=&amp; x'\hat\beta_\tau
    \end{aligned}
\]</span></p>
<p>Where <span class="math inline">\(\hat\beta\)</span> is the vector that solves equation [beta]. Because we solve for the estimator <span class="math inline">\(\hat Q_\tau\)</span> without constructing a likelihood function, it is not straightforward to specify a systematic and stochastic component for conditional quantile estimates. However, systematic and stochastic components do emerge asymptotically in the large- <span class="math inline">\(n\)</span> limit. Asymptotically, <span class="math inline">\(\hat Q_\tau\)</span> is normally distributed, and can be written with <em>stochastic component</em></p>
<p><span class="math display">\[
    \begin{aligned}
        \hat Q_\tau &amp;\sim&amp; \mathcal{N}(\mu, \sigma^2),
    \end{aligned}
\]</span></p>
<p>And <em>systematic components</em></p>
<p><span class="math display">\[
    \begin{aligned}
        \mu &amp;=&amp; x'\hat\beta_\tau\\
       \sigma^2 &amp;=&amp; \frac{\tau(1-\tau)}{n f^2},
    \end{aligned}
\]</span></p>
<p>Where <span class="math inline">\(n\)</span> is the number of datapoints, and <span class="math inline">\(f\)</span> is the true population density at the <span class="math inline">\(\tau\)</span> th conditional quantile. Zelig uses this asymptotic approximation of stochastic and systematic components in simulation and numerically estimates the population density to derive <span class="math inline">\(\sigma^2\)</span>. The simulation results should thus be treated with caution when using small datasets as both this asymptotic approximation and the population density approximation can break down.</p>
</div>
<div id="quantities-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#quantities-of-interest" class="anchor"></a>Quantities of Interest</h2>
<ul>
<li>The expected value (<code>qi$ev</code>) is the mean of simulations from the stochastic component,</li>
</ul>
<p><span class="math display">\[
    E(\hat Q_\tau) = x_i \beta_\tau,
\]</span></p>
<p>given a draw of <span class="math inline">\(\beta_\tau\)</span> from its sampling distribution. Variation in the expected value distribution comes from estimation uncertainty of <span class="math inline">\(\beta_\tau\)</span>.</p>
<ul>
<li><p>The predicted value (<code>qi$pr</code>) is the result of a single draw from the stochastic component given a draw of <span class="math inline">\(\beta_\tau\)</span> from its sampling distribution. The distribution of predicted values should be centered around the same place as the expected values but have larger variance because it includes both estimation uncertainty and fundamental uncertainty.</p></li>
<li><p>This model does not support conditional prediction.</p></li>
</ul>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The Zelig object stores fields containing everything needed to rerun the Zelig output, and all the results and simulations as they are generated. In addition to the summary commands demonstrated above, some simply utility functions (known as <em>getters</em>) provide easy access to the raw fields most commonly of use for further investigation.</p>
<p>In the example above <code>z.out$get_coef()</code> returns the estimated coefficients, <code>z.out$get_vcov()</code> returns the estimated covariance matrix, and <code>z.out$get_predict()</code> provides predicted values for all observations in the dataset from the analysis.</p>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>The quantile regression package quantreg by Richard Koenker. In addition, advanced users may wish to refer to <code>help(rq)</code>, <code>help(summary.rq)</code> and <code>help(rq.object)</code>.</p>
<p>Koenker R (2017). <em>quantreg: Quantile Regression</em>. R package version 5.33, &lt;URL: <a href="https://CRAN.R-project.org/package=quantreg" class="uri">https://CRAN.R-project.org/package=quantreg</a>&gt;.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#additional-inputs">Additional Inputs</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#model">Model</a></li>
      <li><a href="#quantities-of-interest">Quantities of Interest</a></li>
      <li><a href="#output-values">Output Values</a></li>
      <li><a href="#see-also">See also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
