<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Poisson GEE • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Poisson GEE</h1>
            
            <h4 class="date">2017-06-22</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.2.9000</em></p>
<hr>
<p>Generalized Estimating Equation for Poisson Regression with <code>poisson.gee</code>.</p>
<p>The GEE poisson estimates the same model as the standard poisson regression (appropriate when your dependent variable represents the number of independent events that occur during a fixed period of time). Unlike in poisson regression, GEE poisson allows for dependence within clusters, such as in longitudinal data, although its use is not limited to just panel data. The user must first specify a “working” correlation matrix for the clusters, which models the dependence of each observation with other observations in the same cluster. The “working” correlation matrix is a <span class="math inline">\(T \times T\)</span> matrix of correlations, where <span class="math inline">\(T\)</span> is the size of the largest cluster and the elements of the matrix are correlations between within-cluster observations. The appeal of GEE models is that it gives consistent estimates of the parameters and consistent estimates of the standard errors can be obtained using a robust “sandwich” estimator even if the “working” correlation matrix is incorrectly specified. If the “working” correlation matrix is correctly specified, GEE models will give more efficient estimates of the parameters. GEE models measure population-averaged effects as opposed to cluster-specific effects.</p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(Y ~<span class="st"> </span>X1 +<span class="st"> </span>X2, <span class="dt">model =</span> <span class="st">"poisson.gee"</span>,
               <span class="dt">id =</span> <span class="st">"X3"</span>, <span class="dt">weights =</span> w, <span class="dt">data =</span> mydata)
x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)
s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
<p>where <code>id</code> is a variable which identifies the clusters. The data should be sorted by <code>id</code> and should be ordered within each cluster when appropriate.</p>
</div>
<div id="additional-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-inputs" class="anchor"></a>Additional Inputs</h2>
<p>Use the following arguments to specify the structure of the “working” correlations within clusters:</p>
<ul>
<li><p><code>corstr</code>: character string specifying the correlation structure: “independence”, “exchangeable”, “ar1”, “unstructured” and “userdefined”</p></li>
<li><p>See <code>geeglm</code> in package <code>geepack</code> for other function arguments.</p></li>
</ul>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="example-with-exchangeable-dependence" class="section level3">
<h3 class="hasAnchor">
<a href="#example-with-exchangeable-dependence" class="anchor"></a>Example with Exchangeable Dependence</h3>
<p>Attaching the sample turnout dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(sanction)</code></pre></div>
<p>Variable identifying clusters</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sanction$cluster &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">15</span>), <span class="dv">5</span>), <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">16</span>), <span class="dv">3</span>))</code></pre></div>
<p>Sorting by cluster</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sorted.sanction &lt;-<span class="st"> </span>sanction[<span class="kw">order</span>(sanction$cluster),]</code></pre></div>
<p>Estimating model and presenting summary:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(num ~<span class="st"> </span>target +<span class="st"> </span>coop, <span class="dt">model =</span> <span class="st">"poisson.gee"</span>,
               <span class="dt">id =</span> <span class="st">"cluster"</span>, <span class="dt">data =</span> sorted.sanction)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Patrick Lam. 2011.
##   poisson-gee: General Estimating Equation for Poisson Regression
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out)</code></pre></div>
<pre><code>## Model: 
## 
## Call:
## z5$zelig(formula = num ~ target + coop, id = "cluster", data = sorted.sanction)
## 
##  Coefficients:
##             Estimate  Std.err   Wald Pr(&gt;|W|)
## (Intercept) -0.96772  0.45195  4.585   0.0323
## target      -0.02102  0.33111  0.004   0.9494
## coop         1.21082  0.26323 21.158 4.23e-06
## 
## Estimated Scale Parameters:
##             Estimate Std.err
## (Intercept)    16.45   9.136
## 
## Correlation: Structure = independenceNumber of clusters:   16   Maximum cluster size: 5 
## Next step: Use 'setx' method</code></pre>
<p>Set explanatory variables to their default values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)</code></pre></div>
<p>Simulate quantities of interest</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)
<span class="kw">summary</span>(s.out)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##       mean     sd   50%  2.5% 97.5%
## [1,] 3.326 0.8358 3.254 1.978 5.125
## pv
##       mean    sd 50% 2.5% 97.5%
## [1,] 3.319 2.021   3    0     8</code></pre>
<p>Generate a plot of quantities of interest:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s.out)</code></pre></div>
<div class="figure">
<img src="zelig_poissongee_files/figure-html/Zelig-poissongee-1.png" alt="Graphs of Quantities of Interest for Zelig-poissongee" width="672"><p class="caption">
Graphs of Quantities of Interest for Zelig-poissongee
</p>
</div>
</div>
</div>
<div id="the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-model" class="anchor"></a>The Model</h2>
<p>Suppose we have a panel dataset, with <span class="math inline">\(Y_{it}\)</span> denoting the dependent variable of the number of independent events for a fixed period of time for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>. <span class="math inline">\(Y_{i}\)</span> is a vector or cluster of correlated data where <span class="math inline">\(y_{it}\)</span> is correlated with <span class="math inline">\(y_{it^\prime}\)</span> for some or all <span class="math inline">\(t, t^\prime\)</span>. Note that the model assumes correlations within <span class="math inline">\(i\)</span> but independence across <span class="math inline">\(i\)</span>.</p>
<ul>
<li>The <em>stochastic component</em> is given by the joint and marginal distributions</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        Y_{i} &amp;\sim&amp; f(y_{i} \mid \lambda_{i})\\
      Y_{it} &amp;\sim&amp; g(y_{it} \mid \lambda_{it})
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are unspecified distributions with means <span class="math inline">\(\lambda_{i}\)</span> and <span class="math inline">\(\lambda_{it}\)</span>. GEE models make no distributional assumptions and only require three specifications: a mean function, a variance function, and a correlation structure.</p>
<ul>
<li>The <em>systematic component</em> is the <em>mean function</em>, given by:</li>
</ul>
<p><span class="math display">\[
    \lambda_{it}  = \mathrm{exp}(x_{it} \beta)
\]</span></p>
<p>where <span class="math inline">\(x_{it}\)</span> is the vector of <span class="math inline">\(k\)</span> explanatory variables for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> and <span class="math inline">\(\beta\)</span> is the vector of coefficients.</p>
<ul>
<li>The <em>variance function</em> is given by:</li>
</ul>
<p><span class="math display">\[
    V_{it} = \lambda_{it}
\]</span></p>
<ul>
<li>The <em>correlation structure</em> is defined by a <span class="math inline">\(T \times T\)</span> “working” correlation matrix, where <span class="math inline">\(T\)</span> is the size of the largest cluster. Users must specify the structure of the “working” correlation matrix <em>a priori</em>. The “working” correlation matrix then enters the variance term for each <span class="math inline">\(i\)</span>, given by:</li>
</ul>
<p><span class="math display">\[
    V_{i} = \phi \, A_{i}^{\frac{1}{2}} R_{i}(\alpha) A_{i}^{\frac{1}{2}}
\]</span></p>
<p>where <span class="math inline">\(A_{i}\)</span> is a <span class="math inline">\(T \times T\)</span> diagonal matrix with the variance function <span class="math inline">\(V_{it} = \lambda_{it}\)</span> as the <span class="math inline">\(t\)</span> th diagonal element, <span class="math inline">\(R_{i}(\alpha)\)</span> is the “working” correlation matrix, and <span class="math inline">\(\phi\)</span> is a scale parameter. The parameters are then estimated via a quasi-likelihood approach.</p>
<ul>
<li><p>In GEE models, if the mean is correctly specified, but the variance and correlation structure are incorrectly specified, then GEE models provide consistent estimates of the parameters and thus the mean function as well, while consistent estimates of the standard errors can be obtained via a robust “sandwich” estimator. Similarly, if the mean and variance are correctly specified but the correlation structure is incorrectly specified, the parameters can be estimated consistently and the standard errors can be estimated consistently with the sandwich estimator. If all three are specified correctly, then the estimates of the parameters are more efficient.</p></li>
<li><p>The robust “sandwich” estimator gives consistent estimates of the standard errors when the correlations are specified incorrectly only if the number of units <span class="math inline">\(i\)</span> is relatively large and the number of repeated periods <span class="math inline">\(t\)</span> is relatively small. Otherwise, one should use the “naïve” model-based standard errors, which assume that the specified correlations are close approximations to the true underlying correlations. See for more details.</p></li>
</ul>
</div>
<div id="quantities-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#quantities-of-interest" class="anchor"></a>Quantities of Interest</h2>
<ul>
<li><p>All quantities of interest are for marginal means rather than joint means.</p></li>
<li><p>The method of bootstrapping generally should not be used in GEE models. If you must bootstrap, bootstrapping should be done within clusters, which is not currently supported in Zelig. For conditional prediction models, data should be matched within clusters.</p></li>
<li><p>The expected values (qi$ev) for the GEE poisson model is the mean of simulations from the stochastic component:</p></li>
</ul>
<p><span class="math display">\[
    E(Y) =
        \lambda_{c} = \mathrm{exp}(x_{c} \beta),
\]</span></p>
<p>given draws of <span class="math inline">\(\beta\)</span> from its sampling distribution, where <span class="math inline">\(x_{c}\)</span> is a vector of values, one for each independent variable, chosen by the user.</p>
<ul>
<li>The first difference (qi$fd) for the GEE poisson model is defined as</li>
</ul>
<p><span class="math display">\[
    \textrm{FD} = \Pr(Y = 1 \mid x_1) - \Pr(Y = 1 \mid x).
\]</span></p>
<ul>
<li>In conditional prediction models, the average expected treatment effect (att.ev) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \frac{1}{\sum_{i=1}^n \sum_{t=1}^T tr_{it}}\sum_{i:tr_{it}=1}^n \sum_{t:tr_{it}=1}^T \left\{ Y_{it}(tr_{it}=1) -
        E[Y_{it}(tr_{it}=0)] \right\},
\]</span></p>
<p>where <span class="math inline">\(tr_{it}\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(tr_{it}=1\)</span>) and control (<span class="math inline">\(tr_{it}=0\)</span>) groups. Variation in the simulations are due to uncertainty in simulating <span class="math inline">\(E[Y_{it}(tr_{it}=0)]\)</span>, the counterfactual expected value of <span class="math inline">\(Y_{it}\)</span> for observations in the treatment group, under the assumption that everything stays the same except that the treatment indicator is switched to <span class="math inline">\(tr_{it}=0\)</span>.</p>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The output of each Zelig command contains useful information which you may view. For example, if you run <code>z.out &lt;- zelig(y ~ x, model = poisson.gee, id, data)</code>, then you may examine the available information in <code>z.out</code> by using <code>names(z.out)</code>, see the coefficients by using z.out<span class="math inline">\(coefficients, and a default summary of information through `summary(z.out)`. Other elements available through the `\)</span>` operator are listed below.</p>
<p>From the <code><a href="../reference/zelig.html">zelig()</a></code> output object <code>z.out</code>, you may extract:</p>
<ul>
<li><p>coefficients: parameter estimates for the explanatory variables.</p></li>
<li><p>residuals: the working residuals in the final iteration of the fit.</p></li>
<li><p>fitted.values: the vector of fitted values for the systemic component, <span class="math inline">\(\lambda_{it}\)</span>.</p></li>
<li><p>linear.predictors: the vector of <span class="math inline">\(x_{it}\beta\)</span></p></li>
<li><p>max.id: the size of the largest cluster.</p></li>
</ul>
<p>From <code>summary(z.out)</code>, you may extract:</p>
<ul>
<li><p>coefficients: the parameter estimates with their associated standard errors, <span class="math inline">\(p\)</span>-values, and <span class="math inline">\(z\)</span>-statistics.</p></li>
<li><p>working.correlation: the “working” correlation matrix</p></li>
<li><p>From the <code><a href="../reference/sim.html">sim()</a></code> output object s.out, you may extract quantities of interest arranged as matrices indexed by simulation <span class="math inline">\(\times\)</span> x-observation (for more than one x-observation). Available quantities are:</p></li>
<li>
<code>qi$ev</code>: the simulated expected values for the specified values of
<ol start="24" style="list-style-type: lower-alpha">
<li>
</ol>
</li>
<li><p><code>qi$fd</code>: the simulated first difference in the expected probabilities for the values specified in <code>x</code> and <code>x1</code>.</p></li>
<li><p><code>qi$att.ev</code>: the simulated average expected treatment effect for the treated from conditional prediction models.</p></li>
</ul>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>The <code>geeglm</code> function is part of the geepack package by Søren Højsgaard, Ulrich Halekoh and Jun Yan. Advanced users may wish to refer to <code>help(geepack)</code> and <code>help(family)</code>.</p>
<p>HÃ¸jsgaard S, Halekoh U and Yan J (2006). “The R Package geepack for Generalized Estimating Equations.” <em>Journal of Statistical Software</em>, <strong>15/2</strong>, pp. 1-11.</p>
<p>Yan J and Fine JP (2004). “Estimating Equations for Association Structures.” <em>Statistics in Medicine</em>, <strong>23</strong>, pp. 859-880.</p>
<p>Yan J (2002). “geepack: Yet Another Package for Generalized Estimating Equations.” <em>R-News</em>, <strong>2/3</strong>, pp. 12-14.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#additional-inputs">Additional Inputs</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#the-model">The Model</a></li>
      <li><a href="#quantities-of-interest">Quantities of Interest</a></li>
      <li><a href="#output-values">Output Values</a></li>
      <li><a href="#see-also">See also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
