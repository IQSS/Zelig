<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Factor Bayes • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Factor Bayes</h1>
            
            <h4 class="date">2017-06-06</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.1.90000</em></p>
<hr>
<p>Bayesian Factor Analysis with <code>factor.bayes</code>.</p>
<p>Given some unobserved explanatory variables and observed dependent variables, the Normal theory factor analysis model estimates the latent factors. The model is implemented using a Markov Chain Monte Carlo algorithm (Gibbs sampling with data augmentation). <!--For factor analysis
with ordinal dependent variables, see ordered factor analysis (), and
for a mix of types of dependent variables, see the mixed factor analysis
model ().--></p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(<span class="kw">cbind</span>(Y1 ,Y2, Y3) <span class="op">~</span><span class="st"> </span><span class="ot">NULL</span>, <span class="dt">factors =</span> <span class="dv">2</span>,
               <span class="dt">model =</span> <span class="st">"factor.bayes"</span>, <span class="dt">weights =</span> w, <span class="dt">data =</span> mydata)</code></pre></div>
</div>
<div id="inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#inputs" class="anchor"></a>Inputs</h2>
<p>zelig() takes the following functions for factor.bayes:</p>
<ul>
<li><p><code>Y1</code>, <code>Y2</code>, and <code>Y3</code>: variables of interest in factor analysis (manifest variables), assumed to be normally distributed. The model requires a minimum of three manifest variables.</p></li>
<li><p><code>factors</code>: number of the factors to be fitted (defaults to 2).</p></li>
</ul>
</div>
<div id="additional-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-inputs" class="anchor"></a>Additional Inputs</h2>
<p>In addition, zelig() accepts the following additional arguments for model specification:</p>
<ul>
<li><p><code>lambda.constraints</code>: list containing the equality or inequality constraints on the factor loadings. Choose from one of the following forms:</p></li>
<li><p>`varname = list()``: by default, no constraints are imposed.</p></li>
<li><p><code>varname = list(d, c)</code>: constrains the <span class="math inline">\(d\)</span> th loading for the variable named <code>varname</code> to be equal to <code>c</code>.</p></li>
<li><p><code>varname = list(d, +)</code>: constrains the <span class="math inline">\(d\)</span> th loading for the variable named <code>varname</code> to be positive;</p></li>
<li><p><code>varname = list(d, -)</code>: constrains the <span class="math inline">\(d\)</span> th loading for the variable named <code>varname</code> to be negative.</p></li>
<li><p><code>std.var</code>: defaults to FALSE (manifest variables are rescaled to zero mean, but retain observed variance). If <code>TRUE</code>, the manifest variables are rescaled to be mean zero and unit variance.</p></li>
</ul>
<p>In addition, zelig() accepts the following additional inputs for bayes.factor:</p>
<ul>
<li><p><code>burnin</code>: number of the initial MCMC iterations to be discarded (defaults to 1,000).</p></li>
<li><p><code>mcmc</code>: number of the MCMC iterations after burnin (defaults to 20,000).</p></li>
<li><p><code>thin</code>: thinning interval for the Markov chain. Only every <code>thin</code>-th draw from the Markov chain is kept. The value of <code>mcmc</code> must be divisible by this value. The default value is 1.</p></li>
<li><p><code>verbose</code>: defaults to FALSE. If <code>TRUE</code>, the progress of the sampler (every <span class="math inline">\(10\%\)</span>) is printed to the screen.</p></li>
<li><p><code>seed</code>: seed for the random number generator. The default is <code>NA</code> which corresponds to a random seed 12345.</p></li>
<li><p><code>Lambda.start</code>: starting values of the factor loading matrix <span class="math inline">\(\Lambda\)</span>, either a scalar (all unconstrained loadings are set to that value), or a matrix with compatible dimensions. The default is <code>NA</code>, where the start value are set to be 0 for unconstrained factor loadings, and 0.5 or <span class="math inline">\(-\)</span> 0.5 for constrained factor loadings (depending on the nature of the constraints).</p></li>
<li><p><code>Psi.start</code>: starting values for the uniquenesses, either a scalar (the starting values for all diagonal elements of <span class="math inline">\(\Psi\)</span> are set to be this value), or a vector with length equal to the number of manifest variables. In the latter case, the starting values of the diagonal elements of <span class="math inline">\(\Psi\)</span> take the values of <code>Psi.start</code>. The default value is <code>NA</code> where the starting values of the all the uniquenesses are set to be 0.5.</p></li>
<li><p><code>store.lambda</code>: defaults to TRUE, which stores the posterior draws of the factor loadings.</p></li>
<li><p><code>store.scores</code>: defaults to FALSE. If TRUE, stores the posterior draws of the factor scores. (Storing factor scores may take large amount of memory for a large number of draws or observations.)</p></li>
</ul>
<p>The model also accepts the following additional arguments to specify prior parameters:</p>
<ul>
<li><p><code>l0</code>: mean of the Normal prior for the factor loadings, either a scalar or a matrix with the same dimensions as <span class="math inline">\(\Lambda\)</span>. If a scalar value, that value will be the prior mean for all the factor loadings. Defaults to 0.</p></li>
<li><p><code>L0</code>: precision parameter of the Normal prior for the factor loadings, either a scalar or a matrix with the same dimensions as <span class="math inline">\(\Lambda\)</span>. If <code>L0</code> takes a scalar value, then the precision matrix will be a diagonal matrix with the diagonal elements set to that value. The default value is 0, which leads to an improper prior.</p></li>
<li><p><code>a0</code>: the shape parameter of the Inverse Gamma prior for the uniquenesses is <code>a0/2</code>. It can take a scalar value or a vector. The default value is 0.001.</p></li>
<li><p><code>b0</code>: the scale parameter of the Inverse Gamma prior for the uniquenesses is <code>b0/2</code>. It can take a scalar value or a vector. The default value is 0.001.</p></li>
</ul>
<p>Zelig users may wish to refer to <code>help(MCMCfactanal)</code> for more information.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Attaching the sample dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(swiss)
<span class="kw">names</span>(swiss) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Fert"</span>, <span class="st">"Agr"</span>, <span class="st">"Exam"</span>, <span class="st">"Educ"</span>, <span class="st">"Cath"</span>, <span class="st">"InfMort"</span>)</code></pre></div>
<p>Factor analysis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(<span class="op">~</span><span class="st"> </span>Agr <span class="op">+</span><span class="st"> </span>Exam <span class="op">+</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Cath <span class="op">+</span><span class="st"> </span>InfMort,
               <span class="dt">model =</span> <span class="st">"factor.bayes"</span>, <span class="dt">data =</span> swiss,
               <span class="dt">factors =</span> <span class="dv">2</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>,
               <span class="dt">a0 =</span> <span class="dv">1</span>, <span class="dt">b0 =</span> <span class="fl">0.15</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">mcmc =</span> <span class="dv">5000</span>)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park. 2013.
##   factor-bayes: Bayesian Factor Analysis
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<p>Checking for convergence before summarizing the estimates. See the section <a href="diagnostic.html">Diagnostics for Zelig Models</a> for examples of the output with interpretation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out<span class="op">$</span><span class="kw">geweke.diag</span>()</code></pre></div>
<pre><code>## 
## Fraction in 1st window = 0.1
## Fraction in 2nd window = 0.5 
## 
##     LambdaAgr_1     LambdaAgr_2    LambdaExam_1    LambdaExam_2 
##         -2.5274         -0.4865          2.2733          1.1564 
##    LambdaEduc_1    LambdaEduc_2    LambdaCath_1    LambdaCath_2 
##          3.4297         -0.4123         -0.7767         -4.0678 
## LambdaInfMort_1 LambdaInfMort_2          PsiAgr         PsiExam 
##         -1.9580         -6.3315          0.4583         -0.8415 
##         PsiEduc         PsiCath      PsiInfMort 
##          0.3491          0.2581          0.5271</code></pre>
<p>Since the algorithm did not converge, we now add some constraints on <span class="math inline">\(\Lambda\)</span> to optimize the algorithm:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(<span class="op">~</span><span class="st"> </span>Agr <span class="op">+</span><span class="st"> </span>Exam <span class="op">+</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Cath <span class="op">+</span><span class="st"> </span>InfMort,
               <span class="dt">model =</span> <span class="st">"factor.bayes"</span>, <span class="dt">data =</span> swiss, <span class="dt">factors =</span> <span class="dv">2</span>,
               <span class="dt">lambda.constraints =</span>
                   <span class="kw">list</span>(<span class="dt">Exam =</span> <span class="kw">list</span>(<span class="dv">1</span>,<span class="st">"+"</span>),
                        <span class="dt">Exam =</span> <span class="kw">list</span>(<span class="dv">2</span>,<span class="st">"-"</span>),
                        <span class="dt">Educ =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>),
                        <span class="dt">InfMort =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)),
               <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">a0 =</span> <span class="dv">1</span>, <span class="dt">b0 =</span> <span class="fl">0.15</span>,
               <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">mcmc =</span> <span class="dv">5000</span>)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park. 2013.
##   factor-bayes: Bayesian Factor Analysis
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out<span class="op">$</span><span class="kw">geweke.diag</span>()</code></pre></div>
<pre><code>## 
## Fraction in 1st window = 0.1
## Fraction in 2nd window = 0.5 
## 
##     LambdaAgr_1     LambdaAgr_2    LambdaExam_1    LambdaExam_2 
##         0.18321        -0.31899        -0.62450         0.93821 
##    LambdaEduc_1    LambdaCath_1    LambdaCath_2 LambdaInfMort_2 
##        -1.74708        -0.01196         0.88088         1.66103 
##          PsiAgr         PsiExam         PsiEduc         PsiCath 
##        -1.42872         1.21346         0.73458        -0.70383 
##      PsiInfMort 
##         0.24604</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out<span class="op">$</span><span class="kw">heidel.diag</span>()</code></pre></div>
<pre><code>##                                               
##                 Stationarity start     p-value
##                 test         iteration        
## LambdaAgr_1     passed        1        0.404  
## LambdaAgr_2     passed        1        0.476  
## LambdaExam_1    passed        1        0.854  
## LambdaExam_2    passed        1        0.485  
## LambdaEduc_1    passed        1        0.534  
## LambdaCath_1    passed        1        0.887  
## LambdaCath_2    passed        1        0.770  
## LambdaInfMort_2 failed       NA        0.021  
## PsiAgr          passed        1        0.289  
## PsiExam         passed        1        0.828  
## PsiEduc         passed        1        0.301  
## PsiCath         passed        1        0.649  
## PsiInfMort      passed        1        0.414  
##                                           
##                 Halfwidth Mean   Halfwidth
##                 test                      
## LambdaAgr_1     passed    -0.737 0.01479  
## LambdaAgr_2     passed     0.306 0.01497  
## LambdaExam_1    passed     0.816 0.02123  
## LambdaExam_2    passed    -0.520 0.01469  
## LambdaEduc_1    passed     0.949 0.01675  
## LambdaCath_1    failed    -0.195 0.02311  
## LambdaCath_2    passed     0.917 0.02333  
## LambdaInfMort_2 &lt;NA&gt;          NA      NA  
## PsiAgr          passed     0.443 0.00589  
## PsiExam         passed     0.163 0.00943  
## PsiEduc         passed     0.199 0.01552  
## PsiCath         failed     0.209 0.02745  
## PsiInfMort      passed     0.996 0.00651</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out<span class="op">$</span><span class="kw">raftery.diag</span>()</code></pre></div>
<pre><code>## 
## Quantile (q) = 0.025
## Accuracy (r) = +/- 0.005
## Probability (s) = 0.95 
##                                                        
##                  Burn-in  Total Lower bound  Dependence
##                  (M)      (N)   (Nmin)       factor (I)
##  LambdaAgr_1     15       14712 3746         3.93      
##  LambdaAgr_2     30       28143 3746         7.51      
##  LambdaExam_1    10       11258 3746         3.01      
##  LambdaExam_2    10       13332 3746         3.56      
##  LambdaEduc_1    8        10468 3746         2.79      
##  LambdaCath_1    44       37220 3746         9.94      
##  LambdaCath_2    32       32548 3746         8.69      
##  LambdaInfMort_2 3        4198  3746         1.12      
##  PsiAgr          8        10020 3746         2.67      
##  PsiExam         24       23420 3746         6.25      
##  PsiEduc         24       22720 3746         6.07      
##  PsiCath         19       20303 3746         5.42      
##  PsiInfMort      3        4198  3746         1.12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out)</code></pre></div>
<pre><code>## Model: 
## 
## Iterations = 501:5500
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 5000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                    Mean      SD Naive SE Time-series SE
## LambdaAgr_1     -0.7366 0.15317 0.002166       0.007545
## LambdaAgr_2      0.3055 0.14996 0.002121       0.007636
## LambdaExam_1     0.8158 0.15116 0.002138       0.010832
## LambdaExam_2    -0.5197 0.12488 0.001766       0.007492
## LambdaEduc_1     0.9485 0.14205 0.002009       0.008546
## LambdaCath_1    -0.1954 0.17714 0.002505       0.011793
## LambdaCath_2     0.9172 0.16608 0.002349       0.011904
## LambdaInfMort_2  0.1660 0.17111 0.002420       0.004198
## PsiAgr           0.4434 0.11534 0.001631       0.003004
## PsiExam          0.1626 0.07754 0.001097       0.004813
## PsiEduc          0.1989 0.11758 0.001663       0.007919
## PsiCath          0.2087 0.16319 0.002308       0.014003
## PsiInfMort       0.9962 0.22195 0.003139       0.003319
## 
## 2. Quantiles for each variable:
## 
##                      2.5%      25%     50%     75%   97.5%
## LambdaAgr_1     -1.051946 -0.83226 -0.7313 -0.6346 -0.4483
## LambdaAgr_2     -0.002689  0.21719  0.3081  0.4019  0.5888
## LambdaExam_1     0.539739  0.70957  0.8096  0.9138  1.1320
## LambdaExam_2    -0.757806 -0.60299 -0.5184 -0.4394 -0.2779
## LambdaEduc_1     0.689616  0.85378  0.9383  1.0298  1.2579
## LambdaCath_1    -0.559656 -0.31029 -0.1903 -0.0751  0.1338
## LambdaCath_2     0.560127  0.82241  0.9267  1.0197  1.2260
## LambdaInfMort_2 -0.170265  0.05400  0.1639  0.2751  0.5135
## PsiAgr           0.256945  0.36232  0.4308  0.5098  0.7011
## PsiExam          0.038478  0.10442  0.1547  0.2117  0.3334
## PsiEduc          0.033024  0.11025  0.1819  0.2702  0.4671
## PsiCath          0.026496  0.08401  0.1578  0.3005  0.6203
## PsiInfMort       0.649015  0.83760  0.9645  1.1209  1.5143
## 
## Next step: Use 'setx' method</code></pre>
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>Suppose for observation <span class="math inline">\(i\)</span> we observe <span class="math inline">\(K\)</span> variables and hypothesize that there are <span class="math inline">\(d\)</span> underlying factors such that:</p>
<p><span class="math display">\[
    \begin{aligned}
        Y_i = \Lambda \phi_i+\epsilon_i\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(Y_{i}\)</span> is the vector of <span class="math inline">\(K\)</span> manifest variables for observation <span class="math inline">\(i\)</span>. <span class="math inline">\(\Lambda\)</span> is the <span class="math inline">\(K \times d\)</span> factor loading matrix and <span class="math inline">\(\phi_i\)</span> is the <span class="math inline">\(d\)</span>-vector of latent factor scores. Both <span class="math inline">\(\Lambda\)</span> and <span class="math inline">\(\phi\)</span> need to be estimated.</p>
<ul>
<li>The <em>stochastic component</em> is given by:</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \epsilon_{i}  \sim \textrm{Normal}(0, \Psi).\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\Psi\)</span> is a diagonal, positive definite matrix. The diagonal elements of <span class="math inline">\(\Psi\)</span> are referred to as uniquenesses.</p>
<ul>
<li>The <em>systematic component</em> is given by</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \mu_i = E(Y_i) = \Lambda\phi_i\end{aligned}
\]</span></p>
<ul>
<li>The independent conjugate <em>prior</em> for each <span class="math inline">\(\Lambda_{ij}\)</span> is given by</li>
</ul>
$$
<span class="math display">\[\begin{aligned}
        \Lambda_{ij} \sim \textrm{Normal}(l_{0_{ij}}, L_{0_{ij}}^{-1})
      \textrm{ for } i=1,\ldots, k; \quad j=1,\ldots, d. \end{aligned}\]</span>
<ul>
<li>The independent conjugate <em>prior</em> for each <span class="math inline">\(\Psi_{ii}\)</span> is given by</li>
</ul>
$$
<span class="math display">\[\begin{aligned}
        \Psi_{ii} \sim \textrm{InverseGamma}(\frac{a_0}{2}, \frac{b_0}{2}), \textrm{ for }
      i = 1, \ldots, k.\end{aligned}\]</span>
<ul>
<li>The <em>prior</em> for <span class="math inline">\(\phi_i\)</span> is</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        \phi_i &amp;\sim&amp; \textrm{Normal}(0, I_d), \textrm{ for } i = 1, \ldots, n.\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(I_d\)</span> is a $ dd $ identity matrix.</p>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The output of each <code><a href="../reference/zelig.html">zelig()</a></code> call contains useful information which you may view. For example, if you run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(<span class="kw">cbind</span>(Y1, Y2, Y3), <span class="dt">model =</span> <span class="st">"factor.bayes"</span>, data)</code></pre></div>
<p>then you may examine the available information in <code>z.out</code> by using <code>names(z.out)</code>, see the draws from the posterior distribution of the <code>coefficients</code> by using <code>z.out$coefficients</code>, and view a default summary of information through <code>summary(z.out)</code>. Other elements available through the <code>$</code> operator are listed below.</p>
<ul>
<li><p>From the <code><a href="../reference/zelig.html">zelig()</a></code> output object <code>z.out</code>, you may extract:</p></li>
<li><p><code>coefficients</code>: draws from the posterior distributions of the estimated factor loadings and the uniquenesses. If <code>store.scores = TRUE</code>, the estimated factors scores are also contained in <code>coefficients</code>.</p></li>
<li><p><code>data</code>: the name of the input data frame.</p></li>
<li><p><code>seed</code>: the random seed used in the model.</p></li>
<li><p>Since there are no explanatory variables, the <code><a href="../reference/sim.html">sim()</a></code> procedure is not applicable for factor analysis models.</p></li>
</ul>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>Bayesian factor analysis is part of the MCMCpack library by Andrew D. Martin and Kevin M. Quinn. The convergence diagnostics are part of the CODA library by Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines.</p>
<p>Plummer M, Best N, Cowles K and Vines K (2006). “CODA: Convergence Diagnosis and Output Analysis for MCMC.” <em>R News</em>, <strong>6</strong> (1), pp. 7-11. &lt;URL: <a href="https://journal.r-project.org/archive/" class="uri">https://journal.r-project.org/archive/</a>&gt;.</p>
<p>Geweke J (1992). “Evaluating the accuracy of sampling-based approaches to calculating posterior moments.” In Bernado J, Berger J, Dawid A and Smith A (eds.), <em>Bayesian Statistics 4</em>. Clarendon Press, Oxford, UK.</p>
<p>Heidelberger P and Welch P (1983). “Simulation run length control in the presence of an initial transient.” <em>Operations Research</em>, <strong>31</strong>, pp. 1109-44.</p>
<p>Raftery A and Lewis S (1992). “One long run with diagnostics: Implementation strategies for Markov chain Monte Carlo.” <em>Statistical Science</em>, <strong>31</strong>, pp. 1109-44.</p>
<p>Raftery A and Lewis S (1995). “The number of iterations, convergence diagnostics and generic Metropolis algorithms.” In Gilks W, Spiegelhalter D and Richardson S (eds.), <em>Practical Markov Chain Monte Carlo</em>. Chapman and Hall, London, UK.</p>
<p>Martin AD, Quinn KM and Park JH (2011). “MCMCpack: Markov Chain Monte Carlo in R.” <em>Journal of Statistical Software</em>, <strong>42</strong> (9), pp. 22. &lt;URL: <a href="http://www.jstatsoft.org/v42/i09/" class="uri">http://www.jstatsoft.org/v42/i09/</a>&gt;.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#inputs">Inputs</a></li>
      <li><a href="#additional-inputs">Additional Inputs</a></li>
      <li><a href="#example">Example</a></li>
      <li><a href="#model">Model</a></li>
      <li><a href="#output-values">Output Values</a></li>
      <li><a href="#see-also">See also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
