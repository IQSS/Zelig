<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rare Events Logistic • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Rare Events Logistic</h1>
            
            <h4 class="date">2017-06-06</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.1.90000</em></p>
<hr>
<p>Rare Events Logistic Regression for Dichotomous Dependent Variables with <code>relogit</code>.</p>
<p>The relogit procedure estimates the same model as standard logistic regression (appropriate when you have a dichotomous dependent variable and a set of explanatory variables; see ), but the estimates are corrected for the bias that occurs when the sample is small or the observed events are rare (i.e., if the dependent variable has many more 1s than 0s or the reverse). The relogit procedure also optionally uses prior correction for case-control sampling designs.</p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">model =</span> <span class="st">"relogit"</span>, <span class="dt">tau =</span> <span class="ot">NULL</span>,
               <span class="dt">case.control =</span> <span class="kw">c</span>(<span class="st">"prior"</span>, <span class="st">"weighting"</span>),
               <span class="dt">bias.correct =</span> <span class="ot">TRUE</span>,
               <span class="dt">data =</span> mydata, ...)
x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)
s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out)</code></pre></div>
</div>
<div id="arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h2>
<p>The relogit procedure supports four optional arguments in addition to the standard arguments for zelig(). You may additionally use:</p>
<ul>
<li><p>tau: a vector containing either one or two values for <span class="math inline">\(\tau\)</span>, the true population fraction of ones. Use, for example, tau = c(0.05, 0.1) to specify that the lower bound on tau is 0.05 and the upper bound is 0.1. If left unspecified, only finite-sample bias correction is performed, not case-control correction.</p></li>
<li><p>case.control: if tau is specified, choose a method to correct for case-control sampling design: “prior” (default) or “weighting”.</p></li>
<li><p>bias.correct: a logical value of TRUE (default) or FALSE indicating whether the intercept should be corrected for finite sample (rare events) bias.</p></li>
</ul>
<p>Note that if tau = NULL, bias.correct = FALSE, the relogit procedure performs a standard logistic regression without any correction.</p>
</div>
<div id="example-1-one-tau-with-prior-correction-and-bias-correction" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-one-tau-with-prior-correction-and-bias-correction" class="anchor"></a>Example 1: One Tau with Prior Correction and Bias Correction</h2>
<p>Due to memory and space considerations, the data used here are a sample drawn from the full data set used in King and Zeng, 2001, The proportion of militarized interstate conflicts to the absence of disputes is <span class="math inline">\(\tau = 1,042 / 303,772 \approx 0.00343\)</span>. To estimate the model,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(mid)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(conflict <span class="op">~</span><span class="st"> </span>major <span class="op">+</span><span class="st"> </span>contig <span class="op">+</span><span class="st"> </span>power <span class="op">+</span><span class="st"> </span>maxdem <span class="op">+</span><span class="st"> </span>mindem <span class="op">+</span><span class="st"> </span>years,
                <span class="dt">data =</span> mid, <span class="dt">model =</span> <span class="st">"relogit"</span>, <span class="dt">tau =</span> <span class="dv">1042</span><span class="op">/</span><span class="dv">303772</span>)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau. 2017.
##   relogit: Rare Events Logistic Regression for Dichotomous Dependent Variables
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<p>Summarize the model output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out1)</code></pre></div>
<pre><code>## Model: 
## 
## Call:
## z5$zelig(formula = conflict ~ major + contig + power + maxdem + 
##     mindem + years, tau = 1042/303772, data = mid)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.0674  -0.0379  -0.0233   2.1075   4.4581  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept) -7.508360   0.179685 -41.786  &lt; 2e-16
## major        2.431964   0.157561  15.435  &lt; 2e-16
## contig       4.107972   0.157650  26.058  &lt; 2e-16
## power        1.053575   0.217243   4.850 1.24e-06
## maxdem       0.048037   0.010065   4.773 1.82e-06
## mindem      -0.064127   0.012802  -5.009 5.46e-07
## years       -0.062934   0.005705 -11.032  &lt; 2e-16
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 3979.5  on 3125  degrees of freedom
## Residual deviance: 1868.5  on 3119  degrees of freedom
## AIC: 1882.5
## 
## Number of Fisher Scoring iterations: 6
## 
## Next step: Use 'setx' method</code></pre>
<p>Set the explanatory variables to their means:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out1)</code></pre></div>
<p>Simulate quantities of interest:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out1, <span class="dt">x =</span> x.out1)
<span class="kw">summary</span>(s.out1)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##             mean           sd         50%       2.5%      97.5%
## [1,] 0.002398607 0.0001572698 0.002393544 0.00212368 0.00271853
## pv
##          0     1
## [1,] 0.996 0.004</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s.out1)</code></pre></div>
<div class="figure">
<img src="zelig_relogit_files/figure-html/Zelig-relogit1-1.png" alt="Graphs of Quantities of Interest for Rare Events Logistic Regression" width="672"><p class="caption">
Graphs of Quantities of Interest for Rare Events Logistic Regression
</p>
</div>
</div>
<div id="example-2-tau-with-weighting-and-bias-correction" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-tau-with-weighting-and-bias-correction" class="anchor"></a>Example 2: Tau with Weighting and Bias Correction</h2>
<p>Suppose that we wish to perform case control correction using weighting (rather than the default prior correction). To estimate the model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(conflict <span class="op">~</span><span class="st"> </span>major <span class="op">+</span><span class="st"> </span>contig <span class="op">+</span><span class="st"> </span>power <span class="op">+</span><span class="st"> </span>maxdem <span class="op">+</span><span class="st"> </span>mindem <span class="op">+</span><span class="st"> </span>years,
                <span class="dt">data =</span> mid, <span class="dt">model =</span> <span class="st">"relogit"</span>, <span class="dt">tau =</span> <span class="dv">1042</span><span class="op">/</span><span class="dv">303772</span>,
                <span class="dt">case.control =</span> <span class="st">"weighting"</span>)</code></pre></div>
<pre><code>## How to cite this model in Zelig:
##   Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau. 2017.
##   relogit: Rare Events Logistic Regression for Dichotomous Dependent Variables
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   "Zelig: Everyone's Statistical Software," http://zeligproject.org/</code></pre>
<p>Summarize the model output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out2)</code></pre></div>
<pre><code>## Model: 
## 
## Call:
## z5$zelig(formula = conflict ~ major + contig + power + maxdem + 
##     mindem + years, tau = 1042/303772, case.control = "weighting", 
##     data = mid)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.36004  -0.07051  -0.03507   0.17827   0.45330  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept) -5.97463    1.13971  -5.242 1.59e-07
## major        1.69910    0.77375   2.196   0.0281
## contig       3.87763    0.73955   5.243 1.58e-07
## power        0.32808    1.05690   0.310   0.7562
## maxdem       0.06009    0.05088   1.181   0.2376
## mindem      -0.04737    0.07342  -0.645   0.5188
## years       -0.09634    0.04709  -2.046   0.0408
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 143.116  on 3125  degrees of freedom
## Residual deviance:  91.178  on 3119  degrees of freedom
## AIC: 27.041
## 
## Number of Fisher Scoring iterations: 10
## 
## Next step: Use 'setx' method</code></pre>
<p>Set the explanatory variables to their means:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out2)</code></pre></div>
<p>Simulate quantities of interest:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out2, <span class="dt">x =</span> x.out2)
<span class="kw">summary</span>(s.out2)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##            mean          sd         50%        2.5%      97.5%
## [1,] 0.00487475 0.002745702 0.004214592 0.001437013 0.01141024
## pv
##          0     1
## [1,] 0.994 0.006</code></pre>
<!--- Removed in 5.1-0 due to problems with summary
Example 3: Two Taus with Bias Correction and Prior Correction
------

Suppose that we did not know that $\tau \approx 0.00343$, but only
that it was somewhere between $(0.002, 0.005)$. To estimate a
model with a range of feasible estimates for $\tau$ (using the
default prior correction method for case control correction):


```r
z.out2 <- zelig(conflict ~ major + contig + power + maxdem + mindem + years, data = mid, model = "relogit", tau = c(0.002, 0.005))
```

Summarize the model output:


```r
z.out2
```

Set the explanatory variables to their means:


```r
x.out2 <- setx(z.out2)
```

Simulate quantities of interest:


```r
s.out <- sim(z.out2, x = x.out2)
```


```r
summary(s.out2)
```


```r
plot(s.out2)
```

The cost of giving a range of values for $\tau$ is that point
estimates are not available for quantities of interest. Instead,
quantities are presented as confidence intervals with significance less
than or equal to a specified level (e.g., at least 95% of the
simulations are contained in the nominal 95% confidence interval).
--->
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<ul>
<li>Like the standard logistic regression, the <em>stochastic component</em> for the rare events logistic regression is:</li>
</ul>
<p><span class="math display">\[
    Y_i \; \sim \; \textrm{Bernoulli}(\pi_i),
\]</span></p>
<p>where <span class="math inline">\(Y_i\)</span> is the binary dependent variable, and takes a value of either 0 or 1.</p>
<ul>
<li>The <em>systematic component</em> is:</li>
</ul>
<p><span class="math display">\[
    \pi_i \; = \; \frac{1}{1 + \exp(-x_i \beta)}.
\]</span></p>
<ul>
<li>
<p>If the sample is generated via a case-control (or choice-based) design, such as when drawing all events (or “cases”) and a sample from the non-events (or “controls”) and going backwards to collect the explanatory variables, you must correct for selecting on the dependent variable. While the slope coefficients are approximately unbiased, the constant term may be significantly biased. Zelig has two methods for case control correction:</p>
<ul>
<li>The “prior correction” method adjusts the intercept term. Let <span class="math inline">\(\tau\)</span> be the true population fraction of events, <span class="math inline">\(\bar{y}\)</span> the fraction of events in the sample, and <span class="math inline">\(\hat{\beta_0}\)</span> the uncorrected intercept term. The corrected intercept <span class="math inline">\(\beta_0\)</span> is:</li>
</ul>
</li>
</ul>
<p><span class="math display">\[
    \beta =  \hat{\beta_0} - \ln \left[ \bigg( \frac{1 - \tau}{\tau}
        \bigg) \bigg( \frac{\bar{y}}{1 - \bar{y}} \bigg) \right].
\]</span></p>
<ul>
<li>The “weighting” method performs a weighted logistic regression to correct for a case-control sampling design. Let the 1 subscript denote observations for which the dependent variable is observed as a 1, and the 0 subscript denote observations for which the dependent variable is observed as a 0. Then the vector of weights <span class="math inline">\(w_i\)</span>
</li>
</ul>
<p><span class="math display">\[
    \begin{aligned}
        w_1 &amp;=&amp; \frac{\tau}{\bar{y}} \\
         w_0 &amp;=&amp; \frac{(1 - \tau)}{(1 - \bar{y})} \\
         w_i &amp;=&amp; w_1 Y_i + w_0 (1 - Y_i)
\end{aligned}
\]</span></p>
<p>If <span class="math inline">\(\tau\)</span> is unknown, you may alternatively specify an upper and lower bound for the possible range of <span class="math inline">\(\tau\)</span>. In this case, the relogit procedure uses “robust Bayesian” methods to generate a confidence interval (rather than a point estimate) for each quantity of interest. The nominal coverage of the confidence interval is at least as great as the actual coverage.</p>
<ul>
<li>By default, estimates of the the coefficients <span class="math inline">\(\beta\)</span> are bias-corrected to account for finite sample or rare events bias. In addition, quantities of interest, such as predicted probabilities, are also corrected of rare-events bias. If <span class="math inline">\(\widehat{\beta}\)</span> are the uncorrected logit coefficients and bias( <span class="math inline">\(\widehat{\beta}\)</span>) is the bias term, the corrected coefficients <span class="math inline">\(\tilde{\beta}\)</span> are</li>
</ul>
<p><span class="math display">\[
    \widehat{\beta} - \textrm{bias}(\widehat{\beta}) = \tilde{\beta}
\]</span></p>
<p>The bias term is</p>
<p><span class="math display">\[
    \textrm{bias}(\widehat{\beta}) = (X'WX)^{-1} X'W \xi
\]</span></p>
<p>where</p>
<p><span class="math display">\[
    \begin{aligned}
        \xi_i &amp;=&amp; 0.5 Q_{ii} \Big( (1 + w-1)\widehat{\pi}_i - w_1 \Big) \\
      Q &amp;=&amp; X(X'WX)^{-1} X' \\
      W = \textrm{diag}\{\widehat{\pi}_i (1 - \widehat{\pi}_i) w_i\}
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(w_i\)</span> and <span class="math inline">\(w_1\)</span> are given in the “weighting” section above.</p>
</div>
<div id="quantities-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#quantities-of-interest" class="anchor"></a>Quantities of Interest</h2>
<ul>
<li><p>For either one or no <span class="math inline">\(\tau\)</span>:</p></li>
<li><p>The expected values (qi$ev) for the rare events logit are simulations of the predicted probability</p></li>
</ul>
<p><span class="math display">\[
    E(Y) = \pi_i =
        \frac{1}{1 + \exp(-x_i \beta)},
\]</span></p>
<pre><code>  given draws of $\beta$ from its posterior.</code></pre>
<ul>
<li><p>The predicted value (qi$pr) is a draw from a binomial distribution with mean equal to the simulated <span class="math inline">\(\pi_i\)</span>.</p></li>
<li><p>The first difference (qi$fd) is defined as</p></li>
</ul>
<p><span class="math display">\[
    \textrm{FD} = \Pr(Y = 1 \mid x_1, \tau) - \Pr(Y = 1 \mid x, \tau).
\]</span></p>
<ul>
<li>The risk ratio (qi$rr) is defined as</li>
</ul>
<p><span class="math display">\[
    \textrm{RR} = \Pr(Y = 1 \mid x_1, \tau) \ / \ \Pr(Y = 1 \mid x, \tau).
\]</span></p>
<ul>
<li><p>For a range of <span class="math inline">\(\tau\)</span> defined by <span class="math inline">\([\tau_1, \tau_2]\)</span>, each of the quantities of interest are <span class="math inline">\(n \times 2\)</span> matrices, which report the lower and upper bounds, respectively, for a confidence interval with nominal coverage at least as great as the actual coverage. At worst, these bounds are conservative estimates for the likely range for each quantity of interest. Please refer to for the specific method of calculating bounded quantities of interest.</p></li>
<li><p>In conditional prediction models, the average expected treatment effect (att.ev) for the treatment group is</p></li>
</ul>
<p><span class="math display">\[
    \frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
        E[Y_i(t_i=0)] \right\},
\]</span></p>
<p>where <span class="math inline">\(t_i\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_i=1\)</span>) and control (<span class="math inline">\(t_i=0\)</span>) groups. Variation in the simulations are due to uncertainty in simulating <span class="math inline">\(E[Y_i(t_i=0)]\)</span>, the counterfactual expected value of <span class="math inline">\(Y_i\)</span> for observations in the treatment group, under the assumption that everything stays the same except that the treatment indicator is switched to <span class="math inline">\(t_i=0\)</span>.</p>
<ul>
<li>In conditional prediction models, the average predicted treatment effect (att.pr) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
        \widehat{Y_i(t_i=0)} \right\},
\]</span></p>
<p>where <span class="math inline">\(t_i\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_i=1\)</span>) and control (<span class="math inline">\(t_i=0\)</span>) groups. Variation in the simulations are due to uncertainty in simulating <span class="math inline">\(\widehat{Y_i(t_i=0)}\)</span>, the counterfactual predicted value of <span class="math inline">\(Y_i\)</span> for observations in the treatment group, under the assumption that everything stays the same except that the treatment indicator is switched to <span class="math inline">\(t_i=0\)</span>.</p>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The Zelig object stores fields containing everything needed to rerun the Zelig output, and all the results and simulations as they are generated. In addition to the summary commands demonstrated above, some simply utility functions (known as <em>getters</em>) provide easy access to the raw fields most commonly of use for further investigation.</p>
<p>In the example above <code>z.out1$get_coef()</code> returns the estimated coefficients, <code>z.out1$get_vcov()</code> returns the estimated covariance matrix, and <code>z.out1$get_predict()</code> provides predicted values for all observations in the dataset from the analysis.</p>
</div>
<div id="differences-with-stata-version" class="section level2">
<h2 class="hasAnchor">
<a href="#differences-with-stata-version" class="anchor"></a>Differences with Stata Version</h2>
<p>The Stata version of ReLogit and the R implementation differ slightly in their coefficient estimates due to differences in the matrix inversion routines implemented in R and Stata. Zelig uses orthogonal-triangular decomposition (through lm.influence()) to compute the bias term, which is more numerically stable than standard matrix calculations.</p>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>King G and Zeng L (2001). “Logistic Regression in Rare Events Data.” <em>Political Analysis</em>, <strong>9</strong> (2), pp. 137-163.</p>
<p>King G and Zeng L (2001). “Explaining Rare Events in International Relations.” <em>International Organization</em>, <strong>55</strong> (3), pp. 693-715.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#example-1-one-tau-with-prior-correction-and-bias-correction">Example 1: One Tau with Prior Correction and Bias Correction</a></li>
      <li><a href="#example-2-tau-with-weighting-and-bias-correction">Example 2: Tau with Weighting and Bias Correction</a></li>
      <li><a href="#model">Model</a></li>
      <li><a href="#quantities-of-interest">Quantities of Interest</a></li>
      <li><a href="#output-values">Output Values</a></li>
      <li><a href="#differences-with-stata-version">Differences with Stata Version</a></li>
      <li><a href="#see-also">See also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
