<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weights â€¢ Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Weights</h1>
            
            <h4 class="date">2017-06-01</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.1.90000</em></p>
<hr>
<p>Weights are often added to statistical models to adjust the observed sample distribution in the data to an underlying population of interest. For example, some types of observations may have been intentionally oversampled, and need to be downweighted for population inferences, or weights may have been created by a matching procedure to create a dataset with treatment and control groups that resemble randomized designs and achieve balance in covariates.</p>
<p>The weights argument, can be a vector of weight values, or a name of a variable in the dataset.</p>
<p>Not all the R implementations of statistical models that Zelig uses have been written to accept weights or use them in estimation. When weights have been supplied by the user, but weights are not written into the package for that model, Zelig is still able to use the weights by one of two procedures:</p>
<ul>
<li><p>If the supplied weights are all integer values, then Zelig rebuilds a new version of the dataset by duplicating observations according to their weight (and removing observations with zero weight).</p></li>
<li><p>If the weights are continuously valued, Zelig bootstraps the supplied dataset, using the relative weights as bootstrap probabilities.</p></li>
</ul>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>Here we are building a simulated dataset where in the first fifty observations <span class="math inline">\(y\)</span> has a positive relationship with <span class="math inline">\(x\)</span>. In the next fifty observations there is a negative relationship.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">90</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span><span class="op">:</span><span class="dv">45</span>], <span class="op">-</span><span class="dv">3</span><span class="op">*</span>x[<span class="dv">46</span><span class="op">:</span><span class="dv">90</span>] ) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">90</span>)
z &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(y<span class="op">&gt;</span><span class="dv">0</span>)
w1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="fl">1.8</span>, <span class="dv">45</span>), <span class="kw">rep</span>(<span class="fl">0.2</span>,<span class="dv">45</span>))
mydata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,y,x,w1)

w2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="fl">1.8</span>,<span class="fl">0.2</span>), <span class="dv">45</span>)</code></pre></div>
<p>In the first example below, we are passing the name of a variable included in the dataset. We see the weights are correctly implemented as we are more heavily weighting the first 50 observations, where there is a positive relationship, and positive relationship is seen in the regression.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Zelig)</code></pre></div>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z1.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">model =</span> <span class="st">"ls"</span>, <span class="dt">weights =</span> <span class="st">"w1"</span>,
                <span class="dt">data =</span> mydata, <span class="dt">cite =</span> <span class="ot">FALSE</span>)
<span class="kw">summary</span>(z1.out)</code></pre></div>
<pre><code>## Model: 
## 
## Call:
## z5$zelig(formula = y ~ x, data = mydata, weights = "w1")
## 
## Weighted Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.3601 -1.1665 -0.4339  0.2418  3.4678 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  0.09193    0.24889   0.369   0.7127
## x            0.87354    0.45692   1.912   0.0592
## 
## Residual standard error: 1.373 on 88 degrees of freedom
## Multiple R-squared:  0.03988,    Adjusted R-squared:  0.02897 
## F-statistic: 3.655 on 1 and 88 DF,  p-value: 0.05915
## 
## Next step: Use 'setx' method</code></pre>
<p>In our second example, the weights are provided as a separate vector of the same length as the dataset. These weights give weight to both relationships present when we constructed the data, and we see the estimated relationship is now negative.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z2.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">model =</span> <span class="st">"ls"</span>, <span class="dt">weights =</span> w2,
                <span class="dt">data =</span> mydata, <span class="dt">cite =</span> <span class="ot">FALSE</span>)
<span class="kw">summary</span>(z2.out)</code></pre></div>
<pre><code>## Model: 
## 
## Call:
## z5$zelig(formula = y ~ x, data = mydata, weights = w2)
## 
## Weighted Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.4621 -1.0169  0.0147  0.8931  5.2704 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  -0.3517     0.3380  -1.040    0.301
## x            -0.1833     0.5600  -0.327    0.744
## 
## Residual standard error: 1.637 on 88 degrees of freedom
## Multiple R-squared:  0.001216,   Adjusted R-squared:  -0.01013 
## F-statistic: 0.1072 on 1 and 88 DF,  p-value: 0.7442
## 
## Next step: Use 'setx' method</code></pre>
<p>Some checking of the supplied weights are conducted, and warnings or error messages will be given to the user if, for example, the supplied weights are of the wrong length, or the variable name supplied is not present in the dataset. Negative weights are treated as zero weights. Here we use the object oriented approach to building the Zelig object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z3.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">weights =</span> <span class="st">"noSuchName"</span>, <span class="dt">data =</span> mydata, <span class="dt">model =</span> <span class="st">"ls"</span>,
                <span class="dt">cite =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Warning: Variable name given for weights not found in dataset, so will be ignored.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z4.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">weights =</span> w2[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">data =</span> mydata, <span class="dt">model =</span> <span class="st">"ls"</span>,
                <span class="dt">cite =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Warning: Length of vector given for weights is not equal to number of observations in dataset, and will be ignored.</code></pre>
<p>Here we use a model where sampling weights are not accepted by the underlying package, so Zelig gives a warning message that bootstrapping will be conducted to construct a dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">continuous.weights &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="dv">1</span>, <span class="fl">1.4</span>), <span class="dt">times =</span> <span class="dv">30</span>)
z5.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">model =</span> <span class="st">"logit"</span>, <span class="dt">weights =</span> continuous.weights,
                <span class="dt">data =</span> mydata, <span class="dt">cite =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Noninteger weights were set, but the model in Zelig is only able to use integer valued weights.
##  A bootstrapped version of the dataset was constructed using the weights as sample probabilities.</code></pre>
<p>But when the weights happen to be integer valued, then Zelig can construct a dataset by a combination of duplicating and deleting observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">integer.weights &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">times =</span> <span class="dv">30</span>)
z6.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">model =</span> <span class="st">"logit"</span>, <span class="dt">weights =</span> integer.weights,
                <span class="dt">data =</span> mydata, <span class="dt">cite =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
<div id="using-matching-weights-from-matchit" class="section level2">
<h2 class="hasAnchor">
<a href="#using-matching-weights-from-matchit" class="anchor"></a>Using Matching Weights from MatchIt</h2>
<p>Weights that are creating using the matching mechanisms in the <a href="http://gking.harvard.edu/matchit">MatchIt</a> package will be automatically employed in Zelig analyses if the output object from MatchIt is passed to Zelig as the data argument. For more detail, see <a href="using_Zelig_with_Amelia.html">Using Zelig with MatchIt</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#examples">Examples</a></li>
      <li><a href="#using-matching-weights-from-matchit">Using Matching Weights from MatchIt</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
