<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mutlinomial Logit • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Mutlinomial Logit</h1>
            
            <h4 class="date">2017-06-06</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.1.90000</em></p>
<hr>
<p>Multinomial Logistic Regression for Dependent Variables with Unordered Categorical Values with <code>mlogit</code> in ZeligChoice.</p>
<p>Use the multinomial logit distribution to model unordered categorical variables. The dependent variable may be in the format of either character strings or integer values. See <a href="zelig_mlogitbayes.html">Multinomial Bayesian Logistic Regression</a> for a Bayesian version of this model.</p>
<div id="syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax" class="anchor"></a>Syntax</h2>
<p>First load packages:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zeligverse)</code></pre></div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(<span class="kw">as.factor</span>(Y) <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X23,
               <span class="dt">model =</span> <span class="st">"mlogit"</span>, <span class="dt">data =</span> mydata)
x.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out)
s.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out, <span class="dt">x =</span> x.out, <span class="dt">x1 =</span> <span class="ot">NULL</span>)</code></pre></div>
<p>where Y above is supposed to be a factor variable with levels apples,bananas,oranges. By default, oranges is the last level and omitted. (You cannot specify a different base level at this time.) For <span class="math inline">\(J\)</span> equations, there must be <span class="math inline">\(J + 1\)</span> levels.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>Load the sample data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(mexico)</code></pre></div>
<p>Estimate the empirical model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z.out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zelig.html">zelig</a></span>(<span class="kw">as.factor</span>(vote88) <span class="op">~</span><span class="st"> </span>pristr <span class="op">+</span><span class="st"> </span>othcok <span class="op">+</span><span class="st"> </span>othsocok,
                <span class="dt">model =</span> <span class="st">"mlogit"</span>, <span class="dt">data =</span> mexico, <span class="dt">cite =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Summarize estimated paramters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(z.out1)</code></pre></div>
<pre><code>## Model: 
## 
## Call:
## z5$zelig(formula = as.factor(vote88) ~ pristr + othcok + othsocok, 
##     data = mexico)
## 
## 
## Pearson residuals:
##                       Min      1Q  Median      3Q   Max
## log(mu[,1]/mu[,3]) -4.296 -0.6875  0.2791  0.7019 2.102
## log(mu[,2]/mu[,3]) -2.245 -0.4690 -0.2078 -0.0887 4.540
## 
## Coefficients: 
##               Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept):1  2.87082    0.39638   7.243 4.40e-13
## (Intercept):2  0.39915    0.47013   0.849   0.3959
## pristr:1       0.59688    0.09124   6.542 6.07e-11
## pristr:2      -0.12503    0.10428  -1.199   0.2305
## othcok:1      -1.24259    0.11236 -11.059  &lt; 2e-16
## othcok:2      -0.14066    0.13302  -1.057   0.2903
## othsocok:1    -0.30260    0.14960  -2.023   0.0431
## othsocok:2     0.04975    0.16097   0.309   0.7572
## 
## Number of linear predictors:  2 
## 
## Names of linear predictors: log(mu[,1]/mu[,3]), log(mu[,2]/mu[,3])
## 
## Residual deviance: 2360.571 on 2710 degrees of freedom
## 
## Log-likelihood: -1180.286 on 2710 degrees of freedom
## 
## Number of iterations: 4 
## 
## Reference group is level  3  of the response
## Next step: Use 'setx' method</code></pre>
<p>Set the explanatory variables to their default values, with <span class="math inline">\(pristr\)</span> (for the strength of the PRI) equal to 1 (weak) in the baseline values, and equal to 3 (strong) in the alternative values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.weak &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out1, <span class="dt">pristr =</span> <span class="dv">1</span>)
x.strong &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setx.html">setx</a></span>(z.out1, <span class="dt">pristr =</span> <span class="dv">3</span>)</code></pre></div>
<p>Generate simulated predicted probabilities <code>qi$ev</code> and differences in the predicted probabilities <code>qi$fd</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.out.mlogit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim.html">sim</a></span>(z.out1, <span class="dt">x =</span> x.strong, <span class="dt">x1 =</span> x.weak)
<span class="kw">summary</span>(s.out.mlogit)</code></pre></div>
<pre><code>## 
##  sim x :
##  -----
## ev
##              mean         sd       50%      2.5%     97.5%
## Pr(Y=1) 0.7125607 0.02126999 0.7135892 0.6700842 0.7537237
## Pr(Y=2) 0.1288215 0.01480180 0.1277746 0.1026277 0.1603835
## Pr(Y=3) 0.1586178 0.01644167 0.1583075 0.1286804 0.1927543
## pv
##        1     2     3
## [1,] 0.7 0.137 0.163
## 
##  sim x1 :
##  -----
## ev
##              mean         sd       50%      2.5%     97.5%
## Pr(Y=1) 0.4031843 0.02184860 0.4033209 0.3613922 0.4468739
## Pr(Y=2) 0.3040039 0.02187937 0.3037288 0.2645768 0.3488399
## Pr(Y=3) 0.2928118 0.02102680 0.2918071 0.2537728 0.3357307
## pv
##          1     2     3
## [1,] 0.408 0.283 0.309
## fd
##               mean         sd        50%        2.5%      97.5%
## Pr(Y=1) -0.3093764 0.03330788 -0.3098321 -0.37300500 -0.2447529
## Pr(Y=2)  0.1751824 0.02784848  0.1755189  0.12114315  0.2301688
## Pr(Y=3)  0.1341940 0.02792288  0.1345650  0.08144286  0.1892681</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s.out.mlogit)</code></pre></div>
<div class="figure">
<img src="zeligchoice_mlogit_files/figure-html/Zelig-mlogit1-1.png" alt="Graphs of Quantities of Interest for Multinomial Logit" width="672"><p class="caption">
Graphs of Quantities of Interest for Multinomial Logit
</p>
</div>
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>Let <span class="math inline">\(Y_i\)</span> be the unordered categorical dependent variable that takes one of the values from 1 to <span class="math inline">\(J\)</span>, where <span class="math inline">\(J\)</span> is the total number of categories.</p>
<ul>
<li>The stochastic component is given by</li>
</ul>
<p><span class="math display">\[
    Y_i \; \sim \; \textrm{Multinomial}(y_{i} \mid \pi_{ij}),
\]</span></p>
<p>where <span class="math inline">\(\pi_{ij}=\Pr(Y_i=j)\)</span> for <span class="math inline">\(j=1,\dots,J\)</span>.</p>
<ul>
<li>The systemic component is given by:</li>
</ul>
<p><span class="math display">\[
    \pi_{ij}\; = \; \frac{\exp(x_{i}\beta_{j})}{\sum^{J}_{k = 1}
        \exp(x_{i}\beta_{k})},
\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> is the vector of explanatory variables for observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(\beta_j\)</span> is the vector of coefficients for category <span class="math inline">\(j\)</span>.</p>
</div>
<div id="quantities-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#quantities-of-interest" class="anchor"></a>Quantities of Interest</h2>
<ul>
<li>The expected value (qi$ev) is the predicted probability for each category:</li>
</ul>
<p><span class="math display">\[
    E(Y) \; = \; \pi_{ij}\; = \; \frac{\exp(x_{i}\beta_{j})}{\sum^{J}_{k = 1}
        \exp(x_{i}\beta_{k})}.
\]</span></p>
<ul>
<li><p>The predicted value (qi$pr) is a draw from the multinomial distribution defined by the predicted probabilities.</p></li>
<li><p>The first difference in predicted probabilities (qi$fd), for each category is given by:</p></li>
</ul>
<p><span class="math display">\[
    \textrm{FD}_j = \Pr(Y=j \mid x_1) - \Pr(Y=j \mid x) \quad {\rm for}
        \quad j=1,\dots,J.
\]</span></p>
<ul>
<li>In conditional prediction models, the average expected treatment effect (att.ev) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \frac{1}{n_j}\sum_{i:t_i=1}^{n_j} \left\{ Y_i(t_i=1) -
        E[Y_i(t_i=0)] \right\},
\]</span></p>
<p>where <span class="math inline">\(t_{i}\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_{i}=1\)</span>) and control (<span class="math inline">\(t_{i}=0\)</span>) groups, and <span class="math inline">\(n_j\)</span> is the number of treated observations in category <span class="math inline">\(j\)</span>.</p>
<ul>
<li>In conditional prediction models, the average predicted treatment effect (att.pr) for the treatment group is</li>
</ul>
<p><span class="math display">\[
    \frac{1}{n_j}\sum_{i:t_i=1}^{n_j} \left\{ Y_i(t_i=1) -
        \widehat{Y_i(t_i=0)} \right\},
\]</span></p>
<p>where <span class="math inline">\(t_{i}\)</span> is a binary explanatory variable defining the treatment (<span class="math inline">\(t_{i}=1\)</span>) and control (<span class="math inline">\(t_{i}=0\)</span>) groups, and <span class="math inline">\(n_j\)</span> is the number of treated observations in category <span class="math inline">\(j\)</span>.</p>
</div>
<div id="output-values" class="section level2">
<h2 class="hasAnchor">
<a href="#output-values" class="anchor"></a>Output Values</h2>
<p>The Zelig object stores fields containing everything needed to rerun the Zelig output, and all the results and simulations as they are generated. In addition to the summary commands demonstrated above, some simply utility functions (known as <em><a href="getters.html">getters</a></em>) provide easy access to the raw fields most commonly of use for further investigation.</p>
<p>If the <code><a href="../reference/zelig.html">zelig()</a></code> call output object is <code>z.out</code>, then <code>coef(z.out)</code> returns the estimated coefficients, <code>vcov(z.out)</code> returns the estimated covariance matrix, and <code>predict(z.out)</code> provides predicted values for all observations in the dataset from the analysis.</p>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>The multinomial logit function is part of the VGAM package by Thomas Yee. In addition, advanced users may wish to refer to <code>help(vglm)</code> in the VGAM library.</p>
<p>Yee TW (2015). <em>Vector Generalized Linear and Additive Models: With an Implementation in R</em>. Springer, New York, USA.</p>
<p>Yee TW and Wild CJ (1996). “Vector Generalized Additive Models.” <em>Journal of Royal Statistical Society, Series B</em>, <strong>58</strong> (3), pp. 481-493.</p>
<p>Yee TW (2010). “The VGAM Package for Categorical Data Analysis.” <em>Journal of Statistical Software</em>, <strong>32</strong> (10), pp. 1-34. &lt;URL: <a href="http://www.jstatsoft.org/v32/i10/" class="uri">http://www.jstatsoft.org/v32/i10/</a>&gt;.</p>
<p>Yee TW and Hadi AF (2014). “Row-column interaction models, with an R implementation.” <em>Computational Statistics</em>, <strong>29</strong> (6), pp. 1427-1445.</p>
<p>Yee TW (2017). <em>VGAM: Vector Generalized Linear and Additive Models</em>. R package version 1.0-3, &lt;URL: <a href="https://CRAN.R-project.org/package=VGAM" class="uri">https://CRAN.R-project.org/package=VGAM</a>&gt;.</p>
<p>Yee TW (2013). “Two-parameter reduced-rank vector generalized linear models.” <em>Computational Statistics and Data Analysis</em>. &lt;URL: <a href="http://ees.elsevier.com/csda" class="uri">http://ees.elsevier.com/csda</a>&gt;.</p>
<p>Yee TW, Stoklosa J and Huggins RM (2015). “The VGAM Package for Capture-Recapture Data Using the Conditional Likelihood.” <em>Journal of Statistical Software</em>, <strong>65</strong> (5), pp. 1-33. &lt;URL: <a href="http://www.jstatsoft.org/v65/i05/" class="uri">http://www.jstatsoft.org/v65/i05/</a>&gt;.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#syntax">Syntax</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#model">Model</a></li>
      <li><a href="#quantities-of-interest">Quantities of Interest</a></li>
      <li><a href="#output-values">Output Values</a></li>
      <li><a href="#see-also">See also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
